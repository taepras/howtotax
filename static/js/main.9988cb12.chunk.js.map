{"version":3,"sources":["utils/TaxCalculation.js","utils/display.js","theme.js","components/ScaleReference.jsx","data/TaxBrackets.js","components/MoneyBlock.jsx","components/TaxBracketDisplay.jsx","components/D3Component.jsx","components/StoryIndicator.jsx","components/ScrollBox.jsx","App.js","reportWebVitals.js","index.js"],"names":["useNetIncome","income","expense","allowance","useMemo","Math","max","numberWithCommas","x","toString","replace","theme","bg","text","textMuted","incomeText","expenseText","allowanceText","tax","taxText","ScaleReference","scale","barWidth","y","maxSize","textRef","useRef","squareRef","useState","textWidth","setTextWidth","rectSide","ref","side","sqrt","nextSide","useEffect","current","d3","transition","duration","attr","getBBox","width","transform","fill","alignmentBaseline","textAnchor","taxBrackets","minNetIncome","maxNetIncome","taxRate","MoneyBlock","amount","offset","label","isBlink","enableTransition","transitionTime","stroke","transitionDuration","moneyBlockRef","useLayoutEffect","g","select","style","className","stroke-opacity","stroke-dasharray","data-amount","data-offset","fontSize","fillOpacity","TaxBracketDisplay","scaleIncome","scaleTaxRate","showTax","blinkTax","netIncome","active","isPullTax","setPullTax","taxBracketRef","taxMaskRef","generateTaxBracketsPathD","useCallback","pathD","map","d","join","length","bracketLineGroups","selectAll","data","bracketLineGroupsEnter","enter","append","classed","merge","round","toLocaleString","i","id","clipPath","onClick","SvgContainer","styled","div","CartesianSvg","svg","D3Component","incomeGroups","isGroupIncome","showBreakdown","padding","left","right","top","bottom","showBrackets","isActivateTax","useDimensions","onResize","observe","unobserve","height","entry","d3Container","cleanedExpense","cleanedAllowance","min","domain","range","axisIncome","tickFormat","axisTaxRate","call","sum","reduce","a","b","x1","y1","x2","y2","stopColor","stopOpacity","ig","slice","StoryIndicatorContainer","StoryIndicatorItem","props","StoryIndicator","currentStep","totalSteps","steps","FadeTop","FadeBottom","StyledScrollBox","ScrollBox","children","scrollBoxRef","showTopFade","setShowTopFade","showBottomFade","setShowBottomFade","onScroll","scrollTop","offsetHeight","scrollHeight","console","log","addEventListener","removeEventListener","ChartContainer","SideContainer","Step","status","css","ContentContainer","PageContainer","ControlsContainer","ControlsGrid","Button","button","secondary","disabled","NetIncomeEquation","highlight","display","alignItems","marginTop","flexGrow","textAlign","color","fontWeight","App","salary","setSalary","incomeFreelance","setIncomeFreelance","incomeMerchant","setIncomeMerchant","enableIncome","setEnableIncome","salaryDisplay","incomeFreelanceDisplay","incomeMerchantDisplay","enableExpense","setEnableExpense","expense40_1_2","expense40_8","enableAllowance","setEnableAllowance","setAllowance","allowanceDisplay","setGroupIncome","taxFinal","sumTax","remainingNetIncome","bracketRange","useTaxCalculation","setEnableTransition","currentNarrativeStep","setCurrentNarrativeStep","setActivateTax","setShowBrackets","setShowBreakdown","narrativeSteps","type","step","value","onChange","e","target","onMouseDown","onTouchDown","onMouseUp","onTouchUp","gridTemplateColumns","columnGap","marginBottom","rowGap","marginLeft","ceil","flexBasis","margin","gridColumn","opacity","sign","gap","justifyContent","backgroundColor","zIndex","paddingTop","borderRadius","href","class","data-href","data-layout","data-size","data-url","data-via","data-dnt","data-show-count","data-lang","data-type","data-ver","data-color","data-count","border","textDecoration","window","location","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.9988cb12.chunk.js","sourcesContent":["// export const useTaxCalc = ({income, expense, allowance}) => {\r\n//     return \r\n// }\r\n\r\nimport { useMemo } from \"react\"\r\n\r\nexport const useNetIncome = (income, expense, allowance) => {\r\n    return useMemo(() => {\r\n        return Math.max(0, income - expense - allowance);\r\n      }, [income, expense, allowance]);\r\n}\r\n\r\nexport const useTaxCalculation = (netIncome, taxBrackets) => {\r\n    return useMemo(() => {\r\n        let sumTax = 0;\r\n        let remainingNetIncome = netIncome;\r\n        for (let i in taxBrackets) {\r\n          let bracketRange =\r\n            taxBrackets[i].maxNetIncome - taxBrackets[i].minNetIncome;\r\n          let incomeInBracket = Math.min(remainingNetIncome, bracketRange);\r\n          let taxInBracket = incomeInBracket * taxBrackets[i].taxRate;\r\n          sumTax += taxInBracket;\r\n          remainingNetIncome -= bracketRange;\r\n          if (remainingNetIncome <= 0) break;\r\n        }\r\n        return sumTax;\r\n      }, [netIncome, taxBrackets]);\r\n}","export const numberWithCommas = (x) => x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\")\r\n","export const theme = {\r\n    colors: {\r\n        bg: '#1f1629',\r\n        text: '#fff',\r\n        textMuted: '#fff6',\r\n        income: '#08f',\r\n        incomeText: '#0af',\r\n        expense: '#382e59',\r\n        expenseText: '#9c86eb',\r\n        allowance: '#2a4236',\r\n        allowanceText: '#58cc92',\r\n        tax: '#f80',\r\n        taxText: '#f90',\r\n    }\r\n}","import React, { useState, useEffect, useMemo, useRef } from 'react';\r\nimport styled from 'styled-components';\r\nimport * as d3 from 'd3'\r\nimport { numberWithCommas } from '../utils/display';\r\nimport { theme } from '../theme';\r\n\r\nconst ScaleReference = ({ scale, barWidth, x, y, maxSize = 30,...props }) => {\r\n\r\n    const textRef = useRef(null);\r\n    const squareRef = useRef(null);\r\n\r\n    const [textWidth, setTextWidth] = useState(0);\r\n\r\n    const rectSide = useMemo(() => {\r\n        let ref = 1;\r\n        let side = Math.sqrt(scale(ref) * barWidth);\r\n        let nextSide = Math.sqrt(scale(ref * 10) * barWidth);\r\n        while (nextSide < maxSize) {\r\n            side = nextSide;\r\n            ref *= 10;\r\n            nextSide = Math.sqrt(scale(ref * 10) * barWidth);\r\n        }\r\n        return { side, ref };\r\n    }, [scale, barWidth, maxSize]);\r\n\r\n    const text = useMemo(() => `= ${numberWithCommas(rectSide.ref)} บาท`, [rectSide])\r\n\r\n    useEffect(() => {\r\n        if (squareRef.current) {\r\n            d3.select(squareRef.current)\r\n                .transition().duration(500)\r\n                .attr('width', rectSide.side)\r\n                .attr('height', rectSide.side)\r\n                .attr('x', -rectSide.side - textWidth - 10)\r\n                .attr('y', -rectSide.side / 2);\r\n        }\r\n    }, [squareRef, rectSide, textWidth])\r\n    \r\n    useEffect(() => {\r\n        setTextWidth(textRef.current ? textRef.current.getBBox().width : 80);\r\n    }, [textRef, text])\r\n\r\n    return (\r\n        <g transform={`translate(${x}, ${y}) scale(1, -1)`}>\r\n            <rect fill={theme.colors.textMuted} ref={squareRef} />\r\n            <text fill={theme.colors.textMuted} alignmentBaseline=\"middle\" textAnchor=\"end\" x={0} ref={textRef}>\r\n                {text}\r\n            </text>\r\n        </g>\r\n    )\r\n}\r\n\r\nexport default ScaleReference;","export const taxBrackets = [\r\n    {\r\n      minNetIncome: 0,\r\n      maxNetIncome: 150000,\r\n      taxRate: 0,\r\n    },\r\n    {\r\n      minNetIncome: 150000,\r\n      maxNetIncome: 300000,\r\n      taxRate: 0.05,\r\n    },\r\n    {\r\n      minNetIncome: 300000,\r\n      maxNetIncome: 500000,\r\n      taxRate: 0.1,\r\n    },\r\n    {\r\n      minNetIncome: 500000,\r\n      maxNetIncome: 750000,\r\n      taxRate: 0.15,\r\n    },\r\n    {\r\n      minNetIncome: 750000,\r\n      maxNetIncome: 1000000,\r\n      taxRate: 0.2,\r\n    },\r\n    {\r\n      minNetIncome: 1000000,\r\n      maxNetIncome: 2000000,\r\n      taxRate: 0.25,\r\n    },\r\n    {\r\n      minNetIncome: 2000000,\r\n      maxNetIncome: 5000000,\r\n      taxRate: 0.3,\r\n    },\r\n    {\r\n      minNetIncome: 5000000,\r\n      maxNetIncome: 999999999999,\r\n      taxRate: 0.35,\r\n    },\r\n  ];","import React, { useRef, useEffect, useLayoutEffect, useMemo, useCallback, useState } from 'react';\r\nimport * as d3 from 'd3';\r\n// import { transition } from 'd3';\r\nimport useDimensions from \"react-cool-dimensions\";\r\nimport styled from 'styled-components';\r\nimport { useResizeDetector } from 'react-resize-detector';\r\nimport { transition } from 'd3';\r\nimport { useNetIncome } from '../utils/TaxCalculation';\r\nimport ScaleReference from './ScaleReference';\r\n\r\nimport { taxBrackets } from '../data/TaxBrackets';\r\nimport { theme } from '../theme';\r\n\r\n\r\n// const transitionDuration = 1000\r\n\r\nexport const MoneyBlock = ({\r\n    amount,\r\n    offset,\r\n    scale,\r\n    barWidth,\r\n    fill,\r\n    label,\r\n    isBlink,\r\n    enableTransition = true,\r\n    transitionTime = 500,\r\n    stroke,\r\n}) => {\r\n    const transitionDuration = useMemo(() => enableTransition ? transitionTime : 0, [enableTransition, transitionTime]);\r\n\r\n    const moneyBlockRef = useRef(null);\r\n\r\n    useLayoutEffect(() => {\r\n        if (moneyBlockRef.current) {\r\n\r\n            const g = d3.select(moneyBlockRef.current);\r\n\r\n            g.transition().duration(transitionDuration)\r\n                .attr('transform', `translate(0, ${scale(offset)})`);\r\n\r\n            g.select('rect.block')\r\n                .attr('width', barWidth)\r\n                .style('animation', isBlink ? 'blink-from-full 1s infinite' : 'none')\r\n                .transition().duration(transitionDuration)\r\n                .style('fill', fill)\r\n                // .attr('y', scale(offset))\r\n                .attr('height', Math.max(0, scale(amount)));\r\n\r\n            g.select('text.label')\r\n                .text(label)\r\n                .transition().duration(transitionDuration)\r\n                .attr('x', barWidth / 2)\r\n                .attr('y', -scale(amount / 2))\r\n                .attr('opacity', amount > 0 ? 1 : 0)\r\n        }\r\n    }, [\r\n        amount,\r\n        offset,\r\n        scale,\r\n        barWidth,\r\n        fill,\r\n        label,\r\n        isBlink,\r\n        transitionDuration,\r\n        moneyBlockRef\r\n    ]);\r\n\r\n    return (<>\r\n        <g ref={moneyBlockRef}>\r\n            <rect\r\n                className=\"block\"\r\n                width={barWidth}\r\n                fill={fill}\r\n                stroke={theme.colors.text}\r\n                stroke-opacity={stroke ? 0.6 : 0}\r\n                stroke-dasharray=\"3, 3\"\r\n                data-amount={amount}\r\n                data-offset={offset}\r\n            />\r\n            <text className=\"label\" style={{\r\n                fill: theme.colors.text,\r\n                fontSize: '0.75rem',\r\n                alignmentBaseline: 'middle',\r\n                textAnchor: 'middle',\r\n                fillOpacity: 0.6\r\n            }}>{label}</text>\r\n        </g>\r\n    </>);\r\n}","import React, { useRef, useEffect, useLayoutEffect, useMemo, useCallback, useState } from 'react';\r\nimport * as d3 from 'd3';\r\n// import { transition } from 'd3';\r\nimport useDimensions from \"react-cool-dimensions\";\r\nimport styled from 'styled-components';\r\nimport { useResizeDetector } from 'react-resize-detector';\r\nimport { transition } from 'd3';\r\nimport { useNetIncome } from '../utils/TaxCalculation';\r\nimport ScaleReference from './ScaleReference';\r\n\r\nimport { taxBrackets } from '../data/TaxBrackets';\r\nimport { theme } from '../theme';\r\n\r\n\r\n// const transitionDuration = 1000\r\n\r\nexport const TaxBracketDisplay = ({\r\n    barWidth,\r\n    scaleIncome,\r\n    scaleTaxRate,\r\n    showTax,\r\n    blinkTax,\r\n    netIncome,\r\n    // netIncomeMask,\r\n    enableTransition = true,\r\n    active = false,\r\n    transitionTime = 500,\r\n    isPullTax = false,\r\n    setPullTax = () => {},\r\n}) => {\r\n    const transitionDuration = useMemo(() => enableTransition ? transitionTime : 0, [enableTransition, transitionTime]);\r\n\r\n    const taxBracketRef = useRef(null);\r\n    const taxMaskRef = useRef(null);\r\n\r\n    const generateTaxBracketsPathD = useCallback(x => {\r\n        let pathD = 'M 0 0 ';\r\n        pathD += taxBrackets.map((d) => {\r\n            return ''\r\n                + `L ${scaleTaxRate(d.taxRate)} ${scaleIncome(d.minNetIncome)} `\r\n                + `L ${scaleTaxRate(d.taxRate)} ${scaleIncome(d.maxNetIncome)} `\r\n        }).join('')\r\n        pathD += `L 0 ${scaleIncome(taxBrackets[taxBrackets.length - 1].maxNetIncome)} `\r\n        pathD += `Z`\r\n        return pathD;\r\n    }, [scaleIncome, scaleTaxRate]);\r\n\r\n    useLayoutEffect(() => {\r\n        if (taxBracketRef.current && taxMaskRef.current) {\r\n\r\n            const g = d3.select(taxBracketRef.current);\r\n            const mask = d3.select(taxMaskRef.current);\r\n\r\n            mask.attr('width', barWidth)\r\n                .transition().duration(transitionDuration)\r\n                // .style('fill', '#08f')\r\n                .attr('height', Math.max(0, scaleIncome(netIncome)));\r\n\r\n            g.select('path.tax-stairs-camouflage')\r\n                .attr('fill', theme.colors.bg)\r\n                .transition().duration(transitionDuration)\r\n                .attr('opacity', showTax ? 1 : 0)\r\n                .attr('d', generateTaxBracketsPathD)\r\n\r\n            g.select('path.tax-stairs')\r\n                .attr('fill', theme.colors.tax)\r\n                .style('animation', showTax && blinkTax ? 'blink-from-none 1s infinite' : 'none')\r\n                .transition().duration(transitionDuration)\r\n                .attr('d', generateTaxBracketsPathD)\r\n                .attr('transform', isPullTax ? `translate(${-50}, 0)` : 'translate(0, 0)')\r\n                .style('opacity', showTax && !isPullTax ? 1 : 0)\r\n\r\n            const bracketLineGroups = g.select('g.tax-lines')\r\n                .selectAll('g')\r\n                .data(taxBrackets)\r\n\r\n            const bracketLineGroupsEnter = bracketLineGroups\r\n                .enter()\r\n                .append('g')\r\n                .classed('bracket', true)\r\n\r\n            bracketLineGroupsEnter.append('text').classed('bracket-rate-text', true)\r\n            bracketLineGroupsEnter.append('text').classed('bracket-min-text', true)\r\n            bracketLineGroupsEnter.append('rect').classed('bracket-rect', true)\r\n            bracketLineGroupsEnter.append('line').classed('bracket-line', true)\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('rect')\r\n                .attr('x', 0)   // d => scaleTaxRate(d.taxRate))\r\n                .attr('width', d => scaleTaxRate(d.taxRate))\r\n                .style('fill-opacity', 0)\r\n                .style('stroke', theme.colors.tax)\r\n                .style(\"stroke-dasharray\", \"3, 3\")\r\n                .transition().duration(transitionDuration)\r\n                .attr('y', d => scaleIncome(d.minNetIncome))\r\n                .attr('height', d => scaleIncome(d.maxNetIncome - d.minNetIncome))\r\n                .attr('opacity', active ? 1 : 0)\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('line')\r\n                .attr('x1', 0)\r\n                .attr('x2', barWidth)\r\n                .style('stroke', theme.colors.tax)\r\n                .style(\"stroke-dasharray\", \"3, 3\")\r\n                .transition().duration(transitionDuration)\r\n                // .style('stroke-opacity', '0.4')\r\n                .attr('y1', d => Math.round(scaleIncome(d.maxNetIncome)))\r\n                .attr('y2', d => Math.round(scaleIncome(d.maxNetIncome)))\r\n                .attr('opacity', active ? 1 : 0)\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('text.bracket-rate-text')\r\n                .style('fill', theme.colors.text)\r\n                .style('font-size', '0.75rem')\r\n                .style('text-anchor', 'end')\r\n                .attr('x', barWidth - 5)\r\n                .transition().duration(transitionDuration)\r\n                .text(d => `เริ่มคิดที่ ${d.minNetIncome.toLocaleString()} บาท`)\r\n                .style('fill-opacity', (d, i) => i != 0 && scaleIncome(d.maxNetIncome - d.minNetIncome) > 20 ? 1 : 0)\r\n                .attr('y', d => -scaleIncome(d.minNetIncome) - 5)\r\n                .attr('opacity', active ? 1 : 0)\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('text.bracket-min-text')\r\n                .style('fill', theme.colors.text)\r\n                .style('font-size', '0.75rem')\r\n                .attr('x', d => scaleTaxRate(d.taxRate) + 5)\r\n                .transition().duration(transitionDuration)\r\n                .text(d => `ภาษี ${d.taxRate * 100}%`)\r\n                // .text(d => scaleIncome(d.maxNetIncome - d.minNetIncome) > 150\r\n                //     ? `เริ่มคิดที่ ${numberWithCommas(d.minNetIncome)} บาท`\r\n                //     : `${d.taxRate * 100}%`)\r\n                .style('fill-opacity', (d, i) => i != 0 && scaleIncome(d.maxNetIncome - d.minNetIncome) > 20 ? 1 : 0)\r\n                .attr('y', d => -scaleIncome(d.minNetIncome) - 5)\r\n                .attr('opacity', active ? 1 : 0)\r\n        }\r\n    }, [\r\n        taxBracketRef,\r\n        taxMaskRef,\r\n        netIncome,\r\n        scaleTaxRate,\r\n        scaleIncome,\r\n        active,\r\n        showTax,\r\n        blinkTax,\r\n        barWidth,\r\n        generateTaxBracketsPathD,\r\n        isPullTax,\r\n        transitionDuration\r\n    ]);\r\n\r\n    return (<>\r\n        <defs>\r\n            <clipPath id=\"net-income-mask\">\r\n                <rect className=\"net-income-mask\" ref={taxMaskRef}/>\r\n            </clipPath>\r\n        </defs>\r\n        <g id=\"tax-brackets\" ref={taxBracketRef}>\r\n            <g className=\"tax-lines\" />\r\n            <path className=\"tax-stairs-camouflage\" clipPath={`url(#net-income-mask)`} onClick={() => setPullTax(false)} />\r\n            <path className=\"tax-stairs\" clipPath={`url(#net-income-mask)`} onClick={() => setPullTax(!isPullTax)} />\r\n        </g>\r\n    </>);\r\n}","import React, { useRef, useEffect, useLayoutEffect, useMemo, useCallback, useState } from 'react';\r\nimport * as d3 from 'd3';\r\n// import { transition } from 'd3';\r\nimport useDimensions from \"react-cool-dimensions\";\r\nimport styled from 'styled-components';\r\nimport { useResizeDetector } from 'react-resize-detector';\r\nimport { transition } from 'd3';\r\nimport { useNetIncome } from '../utils/TaxCalculation';\r\nimport ScaleReference from './ScaleReference';\r\n\r\nimport { taxBrackets } from '../data/TaxBrackets';\r\nimport { MoneyBlock } from './MoneyBlock';\r\nimport { TaxBracketDisplay } from './TaxBracketDisplay';\r\nimport { theme } from '../theme';\r\n\r\nconst SvgContainer = styled.div`\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n`\r\n\r\nconst CartesianSvg = styled.svg`\r\n    & > g text {\r\n        transform: scale(1, -1);\r\n    }\r\n`\r\n\r\n// const transitionDuration = 1000\r\n\r\nexport const D3Component = ({\r\n    incomeGroups,\r\n    // incomeGroupLabels,\r\n    // expenseGroups,\r\n    isGroupIncome,\r\n    showBreakdown,\r\n\r\n    income,\r\n    expense,\r\n    allowance,\r\n    // taxBrackets,\r\n    padding = {\r\n        left: 35,\r\n        right: 0,\r\n        top: 0,\r\n        bottom: 30,\r\n    },\r\n    isPullTax = false,\r\n    showBrackets = true,\r\n    isActivateTax = true,\r\n    setPullTax = (x) => { },\r\n    transitionTime = 500,\r\n    enableTransition = true,\r\n    isBlink = {}\r\n}) => {\r\n    const { observe, unobserve, width, height, entry } = useDimensions({\r\n        onResize: ({ observe, unobserve, width, height, entry }) => {\r\n            // Triggered whenever the size of the target is changed...\r\n\r\n            unobserve(); // To stop observing the current target element\r\n            observe(); // To re-start observing the current target element\r\n        },\r\n    });\r\n\r\n    const transitionDuration = useMemo(() => enableTransition ? transitionTime : 0, [enableTransition, transitionTime]);\r\n\r\n    const d3Container = useRef(null);\r\n\r\n    const cleanedExpense = useMemo(() => expense < (income - allowance) ? +expense : +Math.max(0, income - allowance), [income, expense]);\r\n    const cleanedAllowance = useMemo(() => Math.min(income, allowance), [income, allowance]);\r\n\r\n    const netIncome = useNetIncome(income, expense, allowance);\r\n\r\n    const scaleIncome = useCallback(\r\n        d3.scaleLinear()\r\n            .domain([0, Math.max(300_000, income * 1.4)])\r\n            .range([0, height - padding.bottom])\r\n        , [height, income, padding])\r\n\r\n    const barWidth = useMemo(() => width - (padding.left + padding.right), [width, padding]);\r\n\r\n    const scaleTaxRate = useCallback(\r\n        d3.scaleLinear()\r\n            .domain([0, 1])\r\n            .range([0, barWidth])\r\n        , [income, width])\r\n\r\n    const axisIncome = useMemo(() => d3.axisLeft(scaleIncome)\r\n        .tickFormat(d3.format(\".3s\"))\r\n        , [scaleIncome]);\r\n    const axisTaxRate = useMemo(() => d3.axisBottom(scaleTaxRate).tickFormat(d3.format('.0%'))\r\n        , [scaleTaxRate]);    \r\n\r\n    useLayoutEffect(() => {\r\n        if (d3Container.current) {\r\n\r\n            const svg = d3.select(d3Container.current);\r\n\r\n            svg.select('g.container')\r\n                .attr('transform', `translate(${padding.left}, ${padding.bottom})`);\r\n\r\n            svg.select('g.overview')\r\n                .transition().duration(transitionDuration)\r\n                .attr('opacity', showBreakdown ? 0 : 1)\r\n\r\n            svg.select('g.breakdown')\r\n                .transition().duration(transitionDuration)\r\n                .attr('opacity', showBreakdown ? 1 : 0)\r\n\r\n            // AXES\r\n\r\n            d3.select(\"g.axis-income\")\r\n                .attr(\"transform\", `translate(0, 0)`)\r\n                .transition().duration(transitionDuration)\r\n                .call(axisIncome);\r\n\r\n            d3.select(\"g.axis-tax-rate\")\r\n                // .attr(\"transform\", `translate(-10, 0)`)\r\n                .transition().duration(transitionDuration)\r\n                .call(axisTaxRate);\r\n        }\r\n    }, [\r\n        d3Container,\r\n        padding,\r\n        axisIncome,\r\n        axisTaxRate,\r\n        showBreakdown,\r\n        transitionDuration,\r\n    ]);\r\n\r\n    const sum = x => x.reduce((a, b) => a + b, 0);\r\n\r\n    return (<>\r\n        <SvgContainer ref={observe}>\r\n            {/* <Fade /> */}\r\n            <CartesianSvg\r\n                id=\"chart\"\r\n                className=\"d3-component\"\r\n                width={width}\r\n                height={height}\r\n                ref={d3Container}\r\n            >\r\n                <defs>\r\n                    <linearGradient id=\"fade-grad\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\r\n                        <stop offset=\"0%\" style={{ stopColor: theme.colors.bg, stopOpacity: 1 }} />\r\n                        <stop offset=\"100%\" style={{ stopColor: theme.colors.bg, stopOpacity: 0 }} />\r\n                    </linearGradient>\r\n                </defs>\r\n\r\n                <g transform={`translate(0, ${height}) scale(1, -1)`}>\r\n                    <g className=\"container\">\r\n                        <g className=\"overview\">\r\n                            <MoneyBlock amount={netIncome} scale={scaleIncome} offset={0} barWidth={barWidth} fill={theme.colors.income} label='เงินได้สุทธิ' stroke={false} enableTransition={enableTransition} isBlink={isBlink.income}/>\r\n                            <MoneyBlock amount={cleanedExpense} scale={scaleIncome} offset={netIncome + cleanedAllowance} barWidth={barWidth} fill={theme.colors.expense} label='ค่าใช้จ่าย' stroke={false} enableTransition={enableTransition}/>\r\n                            <MoneyBlock amount={cleanedAllowance} scale={scaleIncome} offset={netIncome} barWidth={barWidth} fill={theme.colors.allowance} label='ค่าลดหย่อน' stroke={false} enableTransition={enableTransition}/>\r\n                        </g>\r\n                        <g className=\"breakdown\">\r\n                            {incomeGroups.map((ig, i) => <>\r\n                                <MoneyBlock\r\n                                    amount={ig.income - ig.expense}\r\n                                    scale={scaleIncome}\r\n                                    offset={\r\n                                        isGroupIncome\r\n                                            ? sum(incomeGroups.slice(0, i).map(x => x.income - x.expense))\r\n                                            : sum(incomeGroups.slice(0, i).map(x => x.income))\r\n                                    }\r\n                                    barWidth={barWidth}\r\n                                    fill={theme.colors.income}\r\n                                    label={ig.label}\r\n                                    stroke={true} />\r\n                                <MoneyBlock\r\n                                    amount={ig.expense}\r\n                                    scale={scaleIncome}\r\n                                    offset={\r\n                                        isGroupIncome\r\n                                            ? sum(incomeGroups.map(x => x.income - x.expense)) + sum(incomeGroups.slice(0, i).map(x => x.expense))\r\n                                            : sum(incomeGroups.slice(0, i).map(x => x.income)) + (ig.income - +ig.expense)\r\n                                    }\r\n                                    barWidth={barWidth}\r\n                                    fill={theme.colors.expense}\r\n                                    label={'ค่าใช้จ่าย คิดจาก' + ig.label}\r\n                                    stroke={true} />\r\n                            </>)}\r\n                        </g>\r\n\r\n                        <TaxBracketDisplay \r\n                            barWidth={barWidth}\r\n                            scaleIncome={scaleIncome}\r\n                            scaleTaxRate={scaleTaxRate}\r\n                            showTax={isActivateTax}\r\n                            blinkTax={isBlink.tax}\r\n                            active={showBrackets}\r\n                            netIncome={netIncome}\r\n                        />\r\n\r\n                        <g className=\"axis axis-income\" />\r\n                        <g className=\"axis axis-tax-rate\" />\r\n                    </g>\r\n                </g>\r\n                <rect className=\"fade\" fill=\"url(#fade-grad)\" width={width} height={50} />\r\n                <ScaleReference scale={scaleIncome} barWidth={barWidth} x={width} y={40 / 2} maxSize={40} />\r\n            </CartesianSvg>\r\n        </SvgContainer>\r\n    </>);\r\n}","import React, { useMemo } from 'react';\r\nimport styled from 'styled-components';\r\nimport * as d3 from 'd3'\r\n\r\nconst StoryIndicatorContainer = styled.div`\r\n    display: flex;\r\n    gap: 4px;\r\n    position: absolute;\r\n    top: 15px;\r\n    left: 30px;\r\n    right: 30px;\r\n    z-index: 100;\r\n\r\n    @media (min-width: 480px) {\r\n        width: 500px;\r\n        margin: auto;\r\n    }\r\n`\r\n\r\nconst StoryIndicatorItem = styled.div`\r\n    height: 2px;\r\n    flex-grow: 1;\r\n    border-radius: 999;\r\n    background-color: #fff;\r\n    transition: opacity 0.2s;\r\n    opacity: ${props => props.active ? 1 : 0.2};\r\n`\r\n\r\nconst StoryIndicator = ({ currentStep = 0, totalSteps = 0, ...props }) => {\r\n    const steps = useMemo(() => d3.range(totalSteps), [totalSteps]);\r\n\r\n    return (\r\n        <>\r\n            <StoryIndicatorContainer {...props}>\r\n                {steps.map((d, i) => (\r\n                    <StoryIndicatorItem active={i <= currentStep} />\r\n                ))}\r\n            </StoryIndicatorContainer>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default StoryIndicator;","import React, { useCallback, useEffect, useRef, useState } from 'react';\r\nimport styled from 'styled-components';\r\nimport { theme } from '../theme';\r\n\r\nconst FadeTop = styled.div`\r\n    position: absolute;\r\n    top: -2px;\r\n    left: -2px;\r\n    right: -2px;\r\n    height: 50px;\r\n    background: linear-gradient(to bottom, ${theme.colors.bg}f, ${theme.colors.bg}0);\r\n    pointer-events: none;\r\n\r\n    transition: all 0.2s;\r\n    opacity: ${props => props.active ? 1 : 0};\r\n`\r\n\r\nconst FadeBottom = styled.div`\r\n    position: absolute;\r\n    bottom: -2px;\r\n    left: -2px;\r\n    right: -2px;\r\n    height: 50px;\r\n    background: linear-gradient(to top, ${theme.colors.bg}f, ${theme.colors.bg}0);\r\n    pointer-events: none;\r\n\r\n    transition: all 0.2s;\r\n    opacity: ${props => props.active ? 1 : 0};\r\n`\r\n\r\nconst ScrollBoxContainer = styled.div`\r\n    /* position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0; */\r\n    position: relative;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n`\r\n\r\nconst StyledScrollBox = styled.div`\r\n    position: relative;\r\n    flex-grow: 1;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n`\r\n\r\nconst ScrollBox = ({ children, ...props }) => {\r\n    const scrollBoxRef = useRef(null);\r\n    const [showTopFade, setShowTopFade] = useState(true);\r\n    const [showBottomFade, setShowBottomFade] = useState(true);\r\n\r\n    const onScroll = useCallback(() => {\r\n        if (scrollBoxRef.current) {\r\n            setShowTopFade(scrollBoxRef.current.scrollTop > 0);\r\n            setShowBottomFade(scrollBoxRef.current.offsetHeight + scrollBoxRef.current.scrollTop < scrollBoxRef.current.scrollHeight);\r\n        }\r\n    }, [scrollBoxRef]);\r\n\r\n    useEffect(() => {\r\n        if (scrollBoxRef.current) {\r\n            console.log('registering onscroll', onScroll);\r\n            scrollBoxRef.current.addEventListener('scroll', onScroll);\r\n            return () => {\r\n                if (scrollBoxRef.current)\r\n                    scrollBoxRef.current.removeEventListener('scroll', onScroll);\r\n            }\r\n        }\r\n    }, [scrollBoxRef, onScroll])\r\n\r\n    useEffect(onScroll, [scrollBoxRef]);\r\n\r\n    return (\r\n        <>\r\n            <StyledScrollBox ref={scrollBoxRef} {...props}>\r\n                {children}\r\n            </StyledScrollBox>\r\n            <FadeTop active={showTopFade} />\r\n            <FadeBottom active={showBottomFade} />\r\n        </>\r\n    );\r\n}\r\n\r\nexport default ScrollBox;\r\n\r\n","import { useEffect, useMemo, useState } from \"react\";\r\nimport { D3Component } from \"./components/D3Component\";\r\nimport styled, { css } from \"styled-components\";\r\nimport \"./App.css\";\r\nimport { numberWithCommas } from \"./utils/display\";\r\nimport { useNetIncome, useTaxCalculation } from \"./utils/TaxCalculation\";\r\nimport StoryIndicator from \"./components/StoryIndicator\";\r\nimport ScrollBox from \"./components/ScrollBox\";\r\n\r\nimport { taxBrackets } from \"./data/TaxBrackets\";\r\nimport { theme } from \"./theme\";\r\n\r\nconst ChartContainer = styled.div`\r\n  /* padding: 30px; */\r\n  width: 100%;\r\n  margin-top: 10px;\r\n  /* height: 50vh; */\r\n  flex: 1;\r\n  position: relative;\r\n  transition: all 0.2s;\r\n`;\r\n\r\nconst SideContainer = styled.div`\r\n  height: 220px;\r\n  /* overflow-y: auto; */\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: flex-end;\r\n\r\n  @media (min-width: 480px) {\r\n    height: auto;\r\n    margin-left: 80px;\r\n    width: 40%;\r\n    min-width: 300px;\r\n    max-width: 400px;\r\n    justify-content: center;\r\n  }\r\n`;\r\n\r\nconst Step = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  flex-grow: 1;\r\n  transition: all 0.5s;\r\n\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n\r\n  ${(props) => {\r\n    switch (props.status) {\r\n      case -1:\r\n        return css`\r\n          transform: translateX(-100px);\r\n          opacity: 0;\r\n          pointer-events: none;\r\n        `;\r\n        break;\r\n      case 1:\r\n        return css`\r\n          transform: translateX(100px);\r\n          opacity: 0;\r\n          pointer-events: none;\r\n        `;\r\n        break;\r\n      default:\r\n        return css`\r\n          /* transform: translateX(-100px):  */\r\n          /* opacity: 0; */\r\n          /* pointer-events: none; */\r\n        `;\r\n        break;\r\n    }\r\n  }}\r\n`;\r\n\r\nconst StepOnly = styled.div`\r\n  ${(props) => {\r\n    switch (props.status) {\r\n      case -1:\r\n        return css`\r\n          transform: translateX(-100px);\r\n          opacity: 0;\r\n          pointer-events: none;\r\n        `;\r\n        break;\r\n      case 1:\r\n        return css`\r\n          transform: translateX(100px);\r\n          opacity: 0;\r\n          pointer-events: none;\r\n        `;\r\n        break;\r\n      default:\r\n        return css`\r\n          /* transform: translateX(-100px):  */\r\n          /* opacity: 0; */\r\n          /* pointer-events: none; */\r\n        `;\r\n        break;\r\n    }\r\n  }}\r\n`;\r\n\r\nconst ContentContainer = styled.div`\r\n  /* height: 200px; */\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  flex-grow: 1;\r\n  position: relative;\r\n\r\n  @media (min-width: 480px) {\r\n    min-height: 240px;\r\n    flex-grow: 0;\r\n  }\r\n`;\r\n\r\nconst PageContainer = styled.div`\r\n  padding: 30px;\r\n  /* padding-top: 15px; */\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  gap: 10px;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n\r\n  @media (min-width: 480px) {\r\n    flex-direction: row;\r\n    padding: 50px;\r\n  }\r\n`;\r\n\r\nconst ControlsContainer = styled.div`\r\n  /* margin-top: 30px; */\r\n  display: flex;\r\n  /* grid-template-columns: auto auto 80px; */\r\n  /* column-gap: 10px; */\r\n  /* row-gap: 15px; */\r\n  gap: 0.5rem;\r\n  flex-direction: column;\r\n  /* margin-bottom: 30px; */\r\n  align-content: center;\r\n\r\n  label {\r\n    white-space: nowrap;\r\n  }\r\n`;\r\n\r\nconst ControlsGrid = styled.div`\r\n  /* margin-top: 30px; */\r\n  display: grid;\r\n  grid-template-columns: auto auto 80px;\r\n  column-gap: 10px;\r\n  row-gap: 5px;\r\n  /* margin-bottom: 30px; */\r\n  align-content: center;\r\n\r\n  label {\r\n    white-space: nowrap;\r\n  }\r\n`;\r\n\r\nconst InputGroup = styled.div`\r\n  /* margin-bottom: 10px; */\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst Button = styled.button`\r\n  border: none;\r\n  border-radius: 4px;\r\n  padding: 4px 8px;\r\n  font-family: \"Bai Jamjuree\", sans-serif;\r\n\r\n  ${(props) =>\r\n    props.secondary\r\n      ? css`\r\n          border: 1px white solid;\r\n          background-color: transparent;\r\n          color: white;\r\n        `\r\n      : css`\r\n          background-color: white;\r\n        `}\r\n\r\n  ${(props) =>\r\n    props.disabled &&\r\n    css`\r\n      opacity: 0.4;\r\n    `}\r\n`;\r\n\r\nfunction NetIncomeEquation({ income, expense, allowance, highlight = {} }) {\r\n  const netIncome = useNetIncome(income, expense, allowance);\r\n  return (\r\n    <div style={{ display: \"flex\", alignItems: \"center\", marginTop: \"20px\" }}>\r\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n        <small style={{ color: highlight.income ? theme.colors.incomeText : theme.colors.textMuted }}>\r\n          รายได้\r\n        </small>\r\n        <br />\r\n        <small\r\n          style={{\r\n            fontWeight: highlight.income ? \"bold\" : \"normal\",\r\n            color: highlight.income ? theme.colors.text : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          {numberWithCommas(Math.round(income))}\r\n        </small>\r\n      </div>\r\n      <div style={{ color: theme.colors.textMuted }}>−</div>\r\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n        <small style={{ color: highlight.expense ? theme.colors.expenseText : theme.colors.textMuted }}>\r\n          ค่าใช้จ่าย\r\n        </small>\r\n        <br />\r\n        <small\r\n          style={{\r\n            fontWeight: highlight.expense ? \"bold\" : \"normal\",\r\n            color: highlight.expense ? theme.colors.text : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          {numberWithCommas(Math.round(expense))}\r\n        </small>\r\n      </div>\r\n      <div style={{ color: theme.colors.textMuted }}>−</div>\r\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n        <small style={{ color: highlight.allowance ? theme.colors.allowanceText : theme.colors.textMuted }}>\r\n          ลดหย่อน\r\n        </small>\r\n        <br />\r\n        <small\r\n          style={{\r\n            fontWeight: highlight.allowance ? \"bold\" : \"normal\",\r\n            color: highlight.allowance ? theme.colors.text : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          {numberWithCommas(Math.round(allowance))}\r\n        </small>\r\n      </div>\r\n      <div style={{ color: theme.colors.textMuted }}>=</div>\r\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n        <small style={{ color: highlight.netIncome ? theme.colors.incomeText : theme.colors.textMuted }}>\r\n          เงินได้สุทธิ\r\n        </small>\r\n        <br />\r\n        <small\r\n          style={{\r\n            fontWeight: highlight.netIncome ? \"bold\" : \"normal\",\r\n            color: highlight.netIncome ? theme.colors.text : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          {numberWithCommas(Math.round(netIncome))}\r\n        </small>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction App() {\r\n  // income stated & computed numbers\r\n  const [salary, setSalary] = useState(360_000);\r\n  const [incomeFreelance, setIncomeFreelance] = useState(0);\r\n  const [incomeMerchant, setIncomeMerchant] = useState(0);\r\n  const [enableIncome, setEnableIncome] = useState(false);\r\n  const salaryDisplay = useMemo(() => (enableIncome ? salary : 0), [\r\n    enableIncome,\r\n    salary,\r\n  ]);\r\n  const incomeFreelanceDisplay = useMemo(\r\n    () => (enableIncome ? incomeFreelance : 0),\r\n    [enableIncome, incomeFreelance]\r\n  );\r\n  const incomeMerchantDisplay = useMemo(\r\n    () => (enableIncome ? incomeMerchant : 0),\r\n    [enableIncome, incomeMerchant]\r\n  );\r\n  const income = useMemo(\r\n    () => (salaryDisplay + +incomeFreelanceDisplay + +incomeMerchantDisplay : 0),\r\n    [salaryDisplay, incomeMerchantDisplay, incomeFreelanceDisplay]\r\n  );\r\n\r\n  // expense stated & computed numbers\r\n  const [enableExpense, setEnableExpense] = useState(false);\r\n  const expense40_1_2 = useMemo(\r\n    () =>\r\n      enableExpense ? Math.min((salary + +incomeFreelance) * 0.5, 100_000) : 0,\r\n    [salary, incomeFreelance, enableExpense]\r\n  );\r\n  const expense40_8 = useMemo(\r\n    () => (enableExpense ? incomeMerchant * 0.6 : 0),\r\n    [incomeMerchant, enableExpense]\r\n  );\r\n  const expense = useMemo(\r\n    () => (enableExpense ? +expense40_1_2 + +expense40_8 : 0),\r\n    [expense40_1_2, expense40_8, enableExpense]\r\n  );\r\n\r\n  // allowance stated & computed numbers\r\n  const [enableAllowance, setEnableAllowance] = useState(false);\r\n  const [allowance, setAllowance] = useState(60_000);\r\n  const allowanceDisplay = useMemo(() => (enableAllowance ? allowance : 0), [\r\n    allowance,\r\n    enableAllowance,\r\n  ]);\r\n\r\n  const [isGroupIncome, setGroupIncome] = useState(false);\r\n\r\n  const netIncome = useNetIncome(income, expense, allowanceDisplay);\r\n  const taxFinal = useTaxCalculation(netIncome, taxBrackets);\r\n\r\n  const [enableTransition, setEnableTransition] = useState(true);\r\n  const [currentNarrativeStep, setCurrentNarrativeStep] = useState(-1);\r\n\r\n  // display parameters\r\n  const [isPullTax, setPullTax] = useState(false);\r\n  const [isActivateTax, setActivateTax] = useState(false);\r\n  const [showBrackets, setShowBrackets] = useState(false);\r\n  const [showBreakdown, setShowBreakdown] = useState(true);\r\n\r\n  const narrativeSteps = [\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>\r\n        \"<span style={{ color: theme.colors.taxText }}>ภาษีเงินได้บุคคลธรรมดา</span>\" คิดจาก \"\r\n        <span style={{ color: theme.colors.incomeText }}>เงินได้สุทธิ</span>\"\r\n        ซึ่งคำนวณจากรายได้ของเราหลังจากหักค่าใช้จ่ายแล้ว\r\n      </p>\r\n      <div style={{ display: \"flex\", alignItems: \"center\" }}>\r\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n          <span style={{ color: theme.colors.incomeText }}>เงินได้สุทธิ</span>\r\n        </div>\r\n        <div>=</div>\r\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n          <span>รายได้</span>\r\n        </div>\r\n        <div>−</div>\r\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n          <span>ค่าใช้จ่าย</span>\r\n        </div>\r\n        <div>−</div>\r\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n          <span>ค่าลดหย่อน</span>\r\n        </div>\r\n\r\n        {/* <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small>ภาษี</small>\r\n          <br />\r\n          <b>{numberWithCommas(Math.ceil(taxFinal))} </b>\r\n        </div> */}\r\n      </div>\r\n    </>,\r\n\r\n    <>\r\n      <ControlsContainer>\r\n        <div style={{ display: \"flex\" }}>\r\n          <label style={{ flexGrow: 1 }}>เงินเดือน (ทั้งปี รวมโบนัส)</label>\r\n          <input\r\n            type=\"number\"\r\n            step={10_000}\r\n            min={0}\r\n            value={salary}\r\n            onChange={(e) => setSalary(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n        <input\r\n          type=\"range\"\r\n          min=\"0\"\r\n          max=\"10000000\"\r\n          value={salary}\r\n          onChange={(e) => setSalary(e.target.value)}\r\n          onMouseDown={() => setEnableTransition(false)}\r\n          onTouchDown={() => setEnableTransition(false)}\r\n          onMouseUp={() => setEnableTransition(true)}\r\n          onTouchUp={() => setEnableTransition(false)}\r\n        />\r\n      </ControlsContainer>\r\n      {/* <small style={{ marginLeft: \"auto\", color: theme.colors.textMuted }}>\r\n        เงินเดือน &times; 12 = {numberWithCommas(income)} บาท/ปี\r\n      </small> */}\r\n      <NetIncomeEquation\r\n        income={income}\r\n        expense={expense}\r\n        allowance={allowanceDisplay}\r\n        highlight={{ income: true }}\r\n      />\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>\r\n        มีรายได้จากฟรีแลนซ์/ขายของด้วยหรือเปล่า?\r\n      </p>\r\n      <ControlsGrid>\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>\r\n            ฟรีแลนซ์ <span style={{ color: theme.colors.textMuted }}>/ ปี</span>\r\n          </small>\r\n        </label>\r\n        <input\r\n          type=\"range\"\r\n          min=\"0\"\r\n          max=\"1000000\"\r\n          value={incomeFreelance}\r\n          onChange={(e) => setIncomeFreelance(e.target.value)}\r\n          onMouseDown={() => setEnableTransition(false)}\r\n          onTouchDown={() => setEnableTransition(false)}\r\n          onMouseUp={() => setEnableTransition(true)}\r\n          onTouchUp={() => setEnableTransition(false)}\r\n        />\r\n        <div>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={incomeFreelance}\r\n            onChange={(e) => setIncomeFreelance(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>\r\n            ขายของ <span style={{ color: theme.colors.textMuted }}>/ ปี</span>\r\n          </small>\r\n        </label>\r\n        <input\r\n          type=\"range\"\r\n          min=\"0\"\r\n          max=\"1000000\"\r\n          value={incomeMerchant}\r\n          onChange={(e) => setIncomeMerchant(e.target.value)}\r\n          onMouseDown={() => setEnableTransition(false)}\r\n          onTouchDown={() => setEnableTransition(false)}\r\n          onMouseUp={() => setEnableTransition(true)}\r\n          onTouchUp={() => setEnableTransition(false)}\r\n        />\r\n        <div>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={incomeMerchant}\r\n            onChange={(e) => setIncomeMerchant(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n      </ControlsGrid>\r\n      <NetIncomeEquation\r\n        income={income}\r\n        expense={expense}\r\n        allowance={allowanceDisplay}\r\n        highlight={{ income: true }}\r\n      />\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>\r\n        <span style={{ color: theme.colors.expenseText }}>ค่าใช้จ่าย</span>ที่หักได้ คิดจาก\r\n        <span style={{ color: theme.colors.incomeText }}>รายได้</span>แต่ละประเภท\r\n      </p>\r\n      <p\r\n        style={{\r\n          display: \"grid\",\r\n          gridTemplateColumns: \"auto auto\",\r\n          columnGap: \"10px\",\r\n          marginBottom: 0\r\n        }}\r\n      >\r\n        <span style={{ textAlign: \"right\" }}>เงินเดือน</span>\r\n        <span>นับเป็น \"เงินได้ประเภทที่ 1\"</span>\r\n        <span style={{ textAlign: \"right\" }}>เงินจากฟรีแลนซ์</span>\r\n        <span>นับเป็น \"เงินได้ประเภทที่ 2\"</span>\r\n        <span style={{ textAlign: \"right\" }}>เงินจากขายของ</span>\r\n        <span>นับเป็น \"เงินได้ประเภทที่ 8\"</span>\r\n      </p>\r\n      {/* <p style={{ textAlign: \"center\", color: theme.colors.textMuted }}>\r\n        *ตามประมวลรัษฎากร มาตรา 40\r\n      </p> */}\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>แล้วหัก<span style={{ color: theme.colors.expenseText }}>ค่าใช้จ่าย</span>ได้เท่าไหร่?</p>\r\n      <div\r\n        style={{\r\n          display: \"grid\",\r\n          gridTemplateColumns: \"auto auto\",\r\n          columnGap: \"10px\",\r\n          rowGap: \"10px\",\r\n        }}\r\n      >\r\n        <span style={{ textAlign: \"right\" }}>\r\n          เงินเดือน {incomeFreelance > 0 && \"+ ฟรีแลนซ์\"}\r\n        </span>\r\n        <span>\r\n          หักได้ 50% ของรายได้\r\n          <br />\r\n          (ไม่เกิน 100,000 บาท)\r\n        </span>\r\n        {incomeMerchant > 0 && (\r\n          <>\r\n            <span style={{ textAlign: \"right\" }}>ขายของ</span>\r\n            <span>หักได้อย่างน้อย 60%</span>\r\n          </>\r\n        )}\r\n      </div>\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\", marginBottom: 0 }}>\r\n        ดังนั้น คุณหัก<span style={{ color: theme.colors.expenseText }}>ค่าใช้จ่าย</span>ได้รวม\r\n        <br />\r\n        <b style={{ color: theme.colors.expenseText }}>{numberWithCommas(Math.round(expense))}</b> บาท\r\n      </p>\r\n      <NetIncomeEquation\r\n        income={income}\r\n        expense={expense}\r\n        allowance={allowanceDisplay}\r\n        highlight={{ expense: true }}\r\n      />\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>\r\n        นอกจาก<span style={{ color: theme.colors.expenseText }}>ค่าใช้จ่าย</span>แล้ว ก็หัก\r\n        <span style={{ color: theme.colors.allowanceText }}>ค่าลดหย่อน</span>ได้อีก\r\n      </p>\r\n      <p style={{ textAlign: \"center\", marginBottom: 0 }}>\r\n        ซึ่งค่าลดหย่อนมาจากสิ่งต่างๆ ที่เราทำ เช่น\r\n        <br /> ค่าเบี้ยประกันต่างๆ เงินบริจาค ฯลฯ\r\n      </p>\r\n    </>,\r\n\r\n    <>\r\n      {/* <p>ลดหย่อนส่วนตัวได้ 60,000 บาท</p> */}\r\n      <ControlsContainer>\r\n        <div style={{ display: \"flex\" }}>\r\n          <label style={{ flexGrow: 1 }}>ค่าลดหย่อน</label>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={allowance}\r\n            onChange={(e) => setAllowance(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n        <input\r\n          type=\"range\"\r\n          min=\"0\"\r\n          max=\"1000000\"\r\n          value={allowance}\r\n          onChange={(e) => setAllowance(e.target.value)}\r\n          onMouseDown={() => setEnableTransition(false)}\r\n          onTouchDown={() => setEnableTransition(false)}\r\n          onMouseUp={() => setEnableTransition(true)}\r\n          onTouchUp={() => setEnableTransition(false)}\r\n        />\r\n      </ControlsContainer>\r\n      <small style={{ marginLeft: \"auto\", color: theme.colors.textMuted }}>\r\n        ลดหย่อนส่วนตัวได้ 60,000 บาท\r\n      </small>\r\n      <NetIncomeEquation\r\n        income={income}\r\n        expense={expense}\r\n        allowance={allowanceDisplay}\r\n        highlight={{ allowance: true }}\r\n      />\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\", marginBottom: 0 }}>\r\n        ดังนั้น \"<span style={{ color: theme.colors.text }}>เงินได้สุทธิ</span>\" ของคุณคือ\r\n        <br />\r\n        <b style={{ color: theme.colors.incomeText }}>{numberWithCommas(Math.round(netIncome))}</b> บาท\r\n      </p>\r\n      <NetIncomeEquation\r\n        income={income}\r\n        expense={expense}\r\n        allowance={allowanceDisplay}\r\n        highlight={{ netIncome: true }}\r\n      />\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\", marginBottom: 0 }}>\r\n        เมื่อได้ \"<span style={{ color: theme.colors.incomeText }}>เงินได้สุทธิ</span>\" แล้ว\r\n        <br />\r\n        จะต้องนำตัวเลขที่ได้ไปเข้า \"\r\n        <span style={{ color: theme.colors.taxText }}>ขั้นบันไดภาษี</span>\"\r\n        <br />\r\n        เพื่อคำนวณภาษีที่จะต้องจ่าย\r\n      </p>\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>\r\n        ดังนั้น <span style={{ color: theme.colors.text }}>ภาษีเงินได้บุคคลธรรมดา</span>\r\n        <br />\r\n        ที่คุณจะต้องเสียคือ{\" \"}\r\n        <b style={{ color: theme.colors.taxText }}>\r\n          {numberWithCommas(Math.ceil(taxFinal))}\r\n        </b>{\" \"}\r\n        บาท\r\n      </p>\r\n      <div style={{ display: \"flex\", alignItems: \"center\" }}>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.textMuted }}>รายได้</small>\r\n          <br />\r\n          <span style={{ color: theme.colors.textMuted }}>{numberWithCommas(income)}</span>\r\n        </div>\r\n        <div style={{ color: theme.colors.textMuted }}>→</div>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.textMuted }}>เงินได้สุทธิ</small>\r\n          <br />\r\n          <span style={{ color: theme.colors.textMuted }}>{numberWithCommas(netIncome)}</span>\r\n        </div>\r\n        <div style={{ color: theme.colors.textMuted }}>→</div>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.taxText }}>ภาษี</small>\r\n          <br />\r\n          <b>{numberWithCommas(Math.ceil(taxFinal))} </b>\r\n        </div>\r\n      </div>\r\n    </>,\r\n\r\n    // <div\r\n    //   style={{\r\n    //     flexGrow: 1,\r\n    //     display: \"flex\",\r\n    //     flexDirection: \"column\",\r\n    //     // position: \"absolute\",\r\n    //     // top: 0,\r\n    //     // left: 0,\r\n    //     // right: 0,\r\n    //     // bottom: 0,\r\n    //     overflowY: 'auto',\r\n    //     overflowX: 'hidden',\r\n    //   }}\r\n    // >\r\n    <ScrollBox style={{height: '500px'}}>\r\n      <p style={{ marginBottom: \"0.5rem\" }}>\r\n        <b>ลองปรับตัวเลขดู</b>\r\n      </p>\r\n      <div style={{ margin: \"1rem  0 0.5rem\", fontWeight: \"bold\", color: theme.colors.incomeText, display: 'flex' }}>\r\n        <div style={{flexGrow: 1}}>รายได้</div>\r\n        <div>{income.toLocaleString()} บาท</div>\r\n      </div>\r\n      <ControlsGrid>\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>เงินเดือน</small>\r\n        </label>\r\n        <input\r\n          type=\"range\"\r\n          min=\"0\"\r\n          max=\"1000000\"\r\n          value={salary}\r\n          onChange={(e) => setSalary(e.target.value)}\r\n          onMouseDown={() => setEnableTransition(false)}\r\n          onTouchDown={() => setEnableTransition(false)}\r\n          onMouseUp={() => setEnableTransition(true)}\r\n          onTouchUp={() => setEnableTransition(false)}\r\n        />\r\n        <div>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={salary}\r\n            onChange={(e) => setSalary(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>ฟรีแลนซ์</small>\r\n        </label>\r\n        <input\r\n          type=\"range\"\r\n          min=\"0\"\r\n          max=\"1000000\"\r\n          value={incomeFreelance}\r\n          onChange={(e) => setIncomeFreelance(e.target.value)}\r\n          onMouseDown={() => setEnableTransition(false)}\r\n          onTouchDown={() => setEnableTransition(false)}\r\n          onMouseUp={() => setEnableTransition(true)}\r\n          onTouchUp={() => setEnableTransition(false)}\r\n        />\r\n        <div>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={incomeFreelance}\r\n            onChange={(e) => setIncomeFreelance(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>ขายของ</small>\r\n        </label>\r\n        <input\r\n          type=\"range\"\r\n          min=\"0\"\r\n          max=\"1000000\"\r\n          value={incomeMerchant}\r\n          onChange={(e) => setIncomeMerchant(e.target.value)}\r\n          onMouseDown={() => setEnableTransition(false)}\r\n          onTouchDown={() => setEnableTransition(false)}\r\n          onMouseUp={() => setEnableTransition(true)}\r\n          onTouchUp={() => setEnableTransition(false)}\r\n        />\r\n        <div>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={incomeMerchant}\r\n            onChange={(e) => setIncomeMerchant(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n        {/* <small\r\n          style={{\r\n            display: \"block\",\r\n            gridColumn: \"1 / -1\",\r\n            textAlign: \"right\",\r\n            marginLeft: \"auto\",\r\n            color: theme.colors.textMuted,\r\n            marginTop: \"-10px\",\r\n          }}\r\n        >\r\n          เงินเดือน &times; 12 = รายได้ <b>{numberWithCommas(income)}</b> บาท/ปี\r\n        </small> */}\r\n      </ControlsGrid>\r\n\r\n      <div style={{ margin: \"1rem 0 0.5rem\", fontWeight: \"bold\", color: theme.colors.expenseText, display: 'flex' }}>\r\n        <div style={{flexGrow: 1}}>ค่าใช้จ่าย</div>\r\n        <div>{expense.toLocaleString()} บาท</div>\r\n      </div>\r\n      <ControlsGrid>\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>คิดจากเงินเดือน + ฟรีแลนซ์</small>\r\n        </label>\r\n        <div style={{ gridColumn: \"2 / -1\" }}>\r\n          <small>\r\n            หักได้ {numberWithCommas(Math.round(expense40_1_2))} บาท\r\n          </small>\r\n        </div>\r\n\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>คิดจากขายของ</small>\r\n        </label>\r\n        <div style={{ gridColumn: \"2 / -1\" }}>\r\n          <small>หักได้ {numberWithCommas(Math.round(expense40_8))} บาท</small>\r\n        </div>\r\n      </ControlsGrid>\r\n      <div style={{ margin: \"1rem  0 0.5rem\", fontWeight: \"bold\", color: theme.colors.allowanceText, display: 'flex' }}>\r\n        <div style={{flexGrow: 1}}>ค่าลดหย่อน</div>\r\n        <div>{allowance.toLocaleString()} บาท</div>\r\n      </div>\r\n      <ControlsGrid>\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>ค่าลดหย่อน</small>\r\n        </label>\r\n        <input\r\n          type=\"range\"\r\n          min=\"60000\"\r\n          max=\"1000000\"\r\n          value={allowance}\r\n          onChange={(e) => setAllowance(e.target.value)}\r\n          onMouseDown={() => setEnableTransition(false)}\r\n          onTouchDown={() => setEnableTransition(false)}\r\n          onMouseUp={() => setEnableTransition(true)}\r\n          onTouchUp={() => setEnableTransition(false)}\r\n        />\r\n        <input\r\n          type=\"number\"\r\n          step={10000}\r\n          min={0}\r\n          value={allowance}\r\n          onChange={(e) => setAllowance(e.target.value)}\r\n          style={{ width: \"80px\" }}\r\n        />\r\n      </ControlsGrid>\r\n      <hr style={{ margin: \"1rem 0\", opacity: 0.2 }} />\r\n      <div style={{ display: \"flex\", alignItems: \"center\", marginTop: \"10px\" }}>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.incomeText }}>รายได้</small>\r\n          <br />\r\n          <span style={{ color: theme.colors.text }}>{numberWithCommas(income)}</span>\r\n        </div>\r\n        <div>→</div>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.incomeText }}>เงินได้สุทธิ</small>\r\n          <br />\r\n          <span style={{ color: theme.colors.text }}>\r\n            {numberWithCommas(Math.round(netIncome))}\r\n          </span>\r\n        </div>\r\n        <div>→</div>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.taxText }}>ภาษี</small>\r\n          <br />\r\n          <b>{numberWithCommas(Math.ceil(taxFinal))} </b>\r\n        </div>\r\n      </div>\r\n    </ScrollBox>,\r\n    // </div>,\r\n  ];\r\n\r\n  useEffect(() => {\r\n    setEnableIncome(currentNarrativeStep >= 1);\r\n    setEnableExpense(currentNarrativeStep >= 4);\r\n    setGroupIncome(currentNarrativeStep >= 5);\r\n    setShowBreakdown(!(currentNarrativeStep >= 6));\r\n    setEnableAllowance(currentNarrativeStep >= 7);\r\n    setShowBrackets(currentNarrativeStep >= 9);\r\n    setActivateTax(currentNarrativeStep >= 10);\r\n  }, [currentNarrativeStep, enableAllowance, income, expense]);\r\n\r\n  return (\r\n    <>\r\n      <StoryIndicator\r\n        currentStep={currentNarrativeStep}\r\n        totalSteps={narrativeSteps.length + 1}\r\n        style={{ marginBottom: \"20px\" }}\r\n      />\r\n      <PageContainer>\r\n        <Step\r\n          status={Math.sign(-1 - currentNarrativeStep)}\r\n          style={{\r\n            gap: \"10px\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n            backgroundColor: theme.colors.bg,\r\n            zIndex: 100,\r\n            top: 30,\r\n            padding: 50,\r\n            paddingTop: 0,\r\n            textAlign: \"center\",\r\n          }}\r\n        >\r\n          <h1>Tax, visualized.</h1>\r\n          <p>\r\n            คำนวณภาษียากจัง!?\r\n            <br />\r\n            มาลองคำนวณภาษีมนุษย์เงินเดือน\r\n            <br />\r\n            แบบเห็นภาพกัน\r\n          </p>\r\n          <Button\r\n            style={{\r\n              padding: \"8px 16px\",\r\n              borderRadius: 8,\r\n              backgroundColor: theme.colors.tax,\r\n              fontWeight: \"bold\",\r\n              fontSize: \"1rem\",\r\n            }}\r\n            onClick={() => setCurrentNarrativeStep(0)}\r\n          >\r\n            เริ่มเลย\r\n          </Button>\r\n        </Step>\r\n\r\n        <Step\r\n          status={Math.sign(narrativeSteps.length - currentNarrativeStep)}\r\n          style={{\r\n            gap: \"10px\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n            backgroundColor: theme.colors.bg,\r\n            zIndex: 100,\r\n            top: 30,\r\n            padding: 50,\r\n            paddingTop: 0,\r\n            textAlign: \"center\",\r\n          }}\r\n        >\r\n          <p>\r\n            เรื่องราวเกี่ยวกับภาษียังมีรายละเอียดมากกว่านี้อีก\r\n            สามารถอ่านเพิ่มเติมได้ที่เว็บไซต์\r\n            <a href=\"https://www.rd.go.th/548.html\">กรมสรรพากร</a>\r\n          </p>\r\n          <p>\r\n            แต่ถ้าชอบ visualization นี้\r\n            <br />\r\n            แชร์ให้เพื่อนดูต่อได้เลย\r\n          </p>\r\n          <div style={{ display: \"flex\", gap: \"10px\" }}>\r\n            <div\r\n              class=\"fb-share-button\"\r\n              data-href=\"https://taepras.github.io/taxvisualizer/\"\r\n              data-layout=\"button\"\r\n              data-size=\"large\"\r\n            >\r\n              <a\r\n                target=\"_blank\"\r\n                href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ftaepras.github.io%2Ftaxvisualizer%2F&amp;src=sdkpreparse\"\r\n                class=\"fb-xfbml-parse-ignore\"\r\n              >\r\n                Share\r\n              </a>\r\n            </div>\r\n            <a\r\n              href=\"https://twitter.com/share?ref_src=twsrc%5Etfw\"\r\n              class=\"twitter-share-button\"\r\n              data-size=\"large\"\r\n              data-url=\"https://taepras.github.io/taxvisualizer/\"\r\n              data-via=\"taepras\"\r\n              data-dnt=\"true\"\r\n              data-show-count=\"false\"\r\n            >\r\n              Tweet\r\n            </a>\r\n            <div\r\n              class=\"line-it-button\"\r\n              data-lang=\"en\"\r\n              data-type=\"share-a\"\r\n              data-ver=\"3\"\r\n              data-url=\"https://taepras.github.io/taxvisualizer/\"\r\n              data-color=\"default\"\r\n              data-size=\"large\"\r\n              data-count=\"false\"\r\n              // style={{display: 'none'}}\r\n            ></div>\r\n          </div>\r\n\r\n          <div style={{ display: \"flex\", marginTop: \"1rem\", gap: \"10px\" }}>\r\n            <Button\r\n              style={{\r\n                border: \"none\",\r\n                fontSize: \"1rem\",\r\n                textDecoration: \"underline\",\r\n              }}\r\n              secondary\r\n              onClick={() => setCurrentNarrativeStep(narrativeSteps.length - 1)}\r\n            >\r\n              &laquo; ย้อนกลับ\r\n            </Button>\r\n            <Button\r\n              style={{\r\n                border: \"none\",\r\n                fontSize: \"1rem\",\r\n                textDecoration: \"underline\",\r\n              }}\r\n              secondary\r\n              onClick={() => {\r\n                window.location.href = \"\";\r\n              }}\r\n            >\r\n              &laquo; เริ่มใหม่\r\n            </Button>\r\n          </div>\r\n\r\n          <p style={{ marginTop: \"30px\", color: theme.colors.textMuted }}>\r\n            Tax, visualized. was created by\r\n            <br />\r\n            <a href=\"https://taepras.com\" style={{ color: theme.colors.textMuted }}>\r\n              Tae Prasongpongchai\r\n            </a>\r\n          </p>\r\n        </Step>\r\n\r\n        <>\r\n          <ChartContainer>\r\n            <D3Component\r\n              incomeGroups={[\r\n                {\r\n                  label: `เงินเดือน${incomeFreelanceDisplay > 0 ? \" + ฟรีแลนซ์\" : \"\"}`,\r\n                  income: salaryDisplay + +incomeFreelanceDisplay,\r\n                  expense: expense40_1_2,\r\n                },\r\n                {\r\n                  label: \"ขายของ\",\r\n                  income: incomeMerchantDisplay,\r\n                  expense: expense40_8,\r\n                },\r\n              ]}\r\n              isGroupIncome={isGroupIncome}\r\n              showBreakdown={showBreakdown}\r\n              income={income}\r\n              expense={expense}\r\n              allowance={allowanceDisplay}\r\n              isPullTax={isPullTax}\r\n              setPullTax={setPullTax}\r\n              enableTransition={enableTransition}\r\n              isActivateTax={isActivateTax}\r\n              showBrackets={showBrackets}\r\n              isBlink={{\r\n                tax: currentNarrativeStep == 10,\r\n                income: currentNarrativeStep == 8,\r\n                // expense: currentNarrativeStep == 2,\r\n                // allowance: currentNarrativeStep == 3,\r\n              }}\r\n            />\r\n          </ChartContainer>\r\n          <SideContainer>\r\n            <ContentContainer>\r\n              {narrativeSteps.map((step, i) => (\r\n                <>\r\n                  <Step status={Math.sign(i - currentNarrativeStep)}>\r\n                    {step}\r\n                  </Step>\r\n                </>\r\n              ))}\r\n            </ContentContainer>\r\n            <div style={{ display: \"flex\", marginTop: \"20px\", gap: \"20px\" }}>\r\n              <Button\r\n                style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}\r\n                onClick={() =>\r\n                  setCurrentNarrativeStep(\r\n                    Math.max(currentNarrativeStep - 1, -1)\r\n                  )\r\n                }\r\n                // disabled={currentNarrativeStep === 0}\r\n                secondary\r\n              >\r\n                ย้อนกลับ\r\n              </Button>\r\n              <Button\r\n                style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}\r\n                onClick={() =>\r\n                  setCurrentNarrativeStep(\r\n                    Math.min(currentNarrativeStep + 1, narrativeSteps.length)\r\n                  )\r\n                }\r\n                disabled={currentNarrativeStep === narrativeSteps.length}\r\n              >\r\n                ต่อไป\r\n              </Button>\r\n            </div>\r\n          </SideContainer>\r\n        </>\r\n      </PageContainer>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}