{"version":3,"sources":["utils/TaxCalculation.js","theme.js","components/ScaleReference.jsx","utils/display.js","data/TaxBrackets.js","components/MoneyBlock.jsx","components/TaxBracketDisplay.jsx","components/D3Component.jsx","components/StoryIndicator.jsx","components/ScrollBox.jsx","components/Slider.jsx","components/ScrollInstruction.jsx","App.js","reportWebVitals.js","index.js"],"names":["useNetIncome","income","expense","allowance","useMemo","Math","max","theme","bg","text","textMuted","incomeText","expenseText","allowanceText","tax","taxText","ScaleReference","scale","barWidth","x","y","maxSize","textRef","useRef","squareRef","useState","textWidth","setTextWidth","rectSide","ref","side","sqrt","nextSide","toString","replace","numberWithCommas","useEffect","current","d3","transition","duration","attr","getBBox","width","transform","fill","alignmentBaseline","textAnchor","taxBrackets","minNetIncome","maxNetIncome","taxRate","MoneyBlock","amount","offset","label","isBlink","enableTransition","transitionTime","stroke","transitionDuration","moneyBlockRef","useLayoutEffect","g","select","style","className","stroke-opacity","stroke-dasharray","data-amount","data-offset","fontSize","fillOpacity","TaxBracketDisplay","scaleIncome","scaleTaxRate","showTax","blinkTax","netIncome","active","isPullTax","setPullTax","taxBracketRef","taxMaskRef","generateTaxBracketsPathD","useCallback","pathD","map","d","join","length","bracketLineGroups","selectAll","data","bracketLineGroupsEnter","enter","append","classed","merge","round","toLocaleString","i","id","clipPath","onClick","SvgContainer","styled","div","CartesianSvg","svg","D3Component","incomeGroups","isGroupIncome","showBreakdown","padding","left","right","top","bottom","showBrackets","isActivateTax","useDimensions","onResize","observe","unobserve","height","entry","d3Container","cleanedExpense","cleanedAllowance","min","domain","range","axisIncome","tickFormat","axisTaxRate","call","sum","reduce","a","b","x1","y1","x2","y2","stopColor","stopOpacity","ig","slice","StoryIndicatorContainer","StoryIndicatorItem","props","StoryIndicator","currentStep","totalSteps","steps","FadeTop","transparentize","FadeBottom","StyledScrollBox","ScrollBox","children","onScroll","scrollBoxRef","showTopFade","setShowTopFade","showBottomFade","setShowBottomFade","handleScroll","e","scrollTop","offsetHeight","scrollHeight","console","log","addEventListener","removeEventListener","StyledSlider","ReactSlider","StyledThumb","color","darken","StyledTrack","index","Tooltip","visible","Slider","onBeforeChange","onAfterChange","showTooltip","setShowTooltip","renderTrack","state","renderThumb","valueNow","scrollPreview","keyframes","ScrollInstruction","css","process","ChartContainer","SideContainer","Step","status","ContentContainer","PageContainer","ControlsContainer","ControlsGrid","Button","button","secondary","disabled","NetIncomeEquation","highlight","display","alignItems","marginTop","flexGrow","textAlign","fontWeight","App","salary","setSalary","incomeFreelance","setIncomeFreelance","incomeMerchant","setIncomeMerchant","enableIncome","setEnableIncome","salaryDisplay","incomeFreelanceDisplay","incomeMerchantDisplay","enableExpense","setEnableExpense","expense40_1_2","expense40_8","enableAllowance","setEnableAllowance","setAllowance","allowanceDisplay","setGroupIncome","taxFinal","sumTax","remainingNetIncome","bracketRange","useTaxCalculation","currentNarrativeStep","setCurrentNarrativeStep","setActivateTax","setShowBrackets","setShowBreakdown","showDragInstruction","setShowDragInstruction","narrativeSteps","type","step","value","onChange","target","gridTemplateColumns","columnGap","marginBottom","rowGap","marginLeft","ceil","flexBasis","margin","gridColumn","opacity","setTimeout","sign","gap","justifyContent","backgroundColor","zIndex","paddingTop","borderRadius","href","class","data-href","data-layout","data-size","data-url","data-via","data-dnt","data-show-count","data-lang","data-type","data-ver","data-color","data-count","border","textDecoration","window","location","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.300037ab.chunk.js","sourcesContent":["// export const useTaxCalc = ({income, expense, allowance}) => {\r\n//     return \r\n// }\r\n\r\nimport { useMemo } from \"react\"\r\n\r\nexport const useNetIncome = (income, expense, allowance) => {\r\n    return useMemo(() => {\r\n        return Math.max(0, income - expense - allowance);\r\n      }, [income, expense, allowance]);\r\n}\r\n\r\nexport const useTaxCalculation = (netIncome, taxBrackets) => {\r\n    return useMemo(() => {\r\n        let sumTax = 0;\r\n        let remainingNetIncome = netIncome;\r\n        for (let i in taxBrackets) {\r\n          let bracketRange =\r\n            taxBrackets[i].maxNetIncome - taxBrackets[i].minNetIncome;\r\n          let incomeInBracket = Math.min(remainingNetIncome, bracketRange);\r\n          let taxInBracket = incomeInBracket * taxBrackets[i].taxRate;\r\n          sumTax += taxInBracket;\r\n          remainingNetIncome -= bracketRange;\r\n          if (remainingNetIncome <= 0) break;\r\n        }\r\n        return sumTax;\r\n      }, [netIncome, taxBrackets]);\r\n}","export const theme = {\r\n    colors: {\r\n        bg: '#1f1629',\r\n        text: '#fff',\r\n        textMuted: '#888',\r\n        income: '#08f',\r\n        incomeText: '#0af',\r\n        expense: '#382e59',\r\n        expenseText: '#9c86eb',\r\n        allowance: '#2a4236',\r\n        allowanceText: '#58cc92',\r\n        tax: '#f80',\r\n        taxText: '#f90',\r\n    }\r\n}","import React, { useState, useEffect, useMemo, useRef } from 'react';\r\nimport styled from 'styled-components';\r\nimport * as d3 from 'd3'\r\nimport { numberWithCommas } from '../utils/display';\r\nimport { theme } from '../theme';\r\n\r\nconst ScaleReference = ({ scale, barWidth, x, y, maxSize = 30,...props }) => {\r\n\r\n    const textRef = useRef(null);\r\n    const squareRef = useRef(null);\r\n\r\n    const [textWidth, setTextWidth] = useState(0);\r\n\r\n    const rectSide = useMemo(() => {\r\n        let ref = 1;\r\n        let side = Math.sqrt(scale(ref) * barWidth);\r\n        let nextSide = Math.sqrt(scale(ref * 10) * barWidth);\r\n        while (nextSide < maxSize) {\r\n            side = nextSide;\r\n            ref *= 10;\r\n            nextSide = Math.sqrt(scale(ref * 10) * barWidth);\r\n        }\r\n        return { side, ref };\r\n    }, [scale, barWidth, maxSize]);\r\n\r\n    const text = useMemo(() => `= ${numberWithCommas(rectSide.ref)} บาท`, [rectSide])\r\n\r\n    useEffect(() => {\r\n        if (squareRef.current) {\r\n            d3.select(squareRef.current)\r\n                .transition().duration(500)\r\n                .attr('width', rectSide.side)\r\n                .attr('height', rectSide.side)\r\n                .attr('x', -rectSide.side - textWidth - 10)\r\n                .attr('y', -rectSide.side / 2);\r\n        }\r\n    }, [squareRef, rectSide, textWidth])\r\n    \r\n    useEffect(() => {\r\n        setTextWidth(textRef.current ? textRef.current.getBBox().width : 80);\r\n    }, [textRef, text])\r\n\r\n    return (\r\n        <g transform={`translate(${x}, ${y}) scale(1, -1)`}>\r\n            <rect fill={theme.colors.textMuted} ref={squareRef} />\r\n            <text fill={theme.colors.textMuted} alignmentBaseline=\"middle\" textAnchor=\"end\" x={0} ref={textRef}>\r\n                {text}\r\n            </text>\r\n        </g>\r\n    )\r\n}\r\n\r\nexport default ScaleReference;","export const numberWithCommas = (x) => x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\")\r\n","export const taxBrackets = [\r\n    {\r\n      minNetIncome: 0,\r\n      maxNetIncome: 150000,\r\n      taxRate: 0,\r\n    },\r\n    {\r\n      minNetIncome: 150000,\r\n      maxNetIncome: 300000,\r\n      taxRate: 0.05,\r\n    },\r\n    {\r\n      minNetIncome: 300000,\r\n      maxNetIncome: 500000,\r\n      taxRate: 0.1,\r\n    },\r\n    {\r\n      minNetIncome: 500000,\r\n      maxNetIncome: 750000,\r\n      taxRate: 0.15,\r\n    },\r\n    {\r\n      minNetIncome: 750000,\r\n      maxNetIncome: 1000000,\r\n      taxRate: 0.2,\r\n    },\r\n    {\r\n      minNetIncome: 1000000,\r\n      maxNetIncome: 2000000,\r\n      taxRate: 0.25,\r\n    },\r\n    {\r\n      minNetIncome: 2000000,\r\n      maxNetIncome: 5000000,\r\n      taxRate: 0.3,\r\n    },\r\n    {\r\n      minNetIncome: 5000000,\r\n      maxNetIncome: 999999999999,\r\n      taxRate: 0.35,\r\n    },\r\n  ];","import React, { useRef, useEffect, useLayoutEffect, useMemo, useCallback, useState } from 'react';\r\nimport * as d3 from 'd3';\r\n// import { transition } from 'd3';\r\nimport useDimensions from \"react-cool-dimensions\";\r\nimport styled from 'styled-components';\r\nimport { useResizeDetector } from 'react-resize-detector';\r\nimport { transition } from 'd3';\r\nimport { useNetIncome } from '../utils/TaxCalculation';\r\nimport ScaleReference from './ScaleReference';\r\n\r\nimport { taxBrackets } from '../data/TaxBrackets';\r\nimport { theme } from '../theme';\r\n\r\n\r\n// const transitionDuration = 1000\r\n\r\nexport const MoneyBlock = ({\r\n    amount,\r\n    offset,\r\n    scale,\r\n    barWidth,\r\n    fill,\r\n    label,\r\n    isBlink,\r\n    enableTransition = true,\r\n    transitionTime = 500,\r\n    stroke,\r\n}) => {\r\n    const transitionDuration = useMemo(() => enableTransition ? transitionTime : 0, [enableTransition, transitionTime]);\r\n\r\n    const moneyBlockRef = useRef(null);\r\n\r\n    useLayoutEffect(() => {\r\n        if (moneyBlockRef.current) {\r\n\r\n            const g = d3.select(moneyBlockRef.current);\r\n\r\n            g.transition().duration(transitionDuration)\r\n                .attr('transform', `translate(0, ${scale(offset)})`);\r\n\r\n            g.select('rect.block')\r\n                .attr('width', barWidth)\r\n                .style('animation', isBlink ? 'blink-from-full 1s infinite' : 'none')\r\n                .transition().duration(transitionDuration)\r\n                .style('fill', fill)\r\n                // .attr('y', scale(offset))\r\n                .attr('height', Math.max(0, scale(amount)));\r\n\r\n            g.select('text.label')\r\n                .text(label)\r\n                .transition().duration(transitionDuration)\r\n                .attr('x', barWidth / 2)\r\n                .attr('y', -scale(amount / 2))\r\n                .attr('opacity', amount > 0 ? 1 : 0)\r\n        }\r\n    }, [\r\n        amount,\r\n        offset,\r\n        scale,\r\n        barWidth,\r\n        fill,\r\n        label,\r\n        isBlink,\r\n        transitionDuration,\r\n        moneyBlockRef\r\n    ]);\r\n\r\n    return (<>\r\n        <g ref={moneyBlockRef}>\r\n            <rect\r\n                className=\"block\"\r\n                width={barWidth}\r\n                fill={fill}\r\n                stroke={theme.colors.text}\r\n                stroke-opacity={stroke ? 0.6 : 0}\r\n                stroke-dasharray=\"3, 3\"\r\n                data-amount={amount}\r\n                data-offset={offset}\r\n            />\r\n            <text className=\"label\" style={{\r\n                fill: theme.colors.text,\r\n                fontSize: '0.75rem',\r\n                alignmentBaseline: 'middle',\r\n                textAnchor: 'middle',\r\n                fillOpacity: 0.6\r\n            }}>{label}</text>\r\n        </g>\r\n    </>);\r\n}","import React, { useRef, useEffect, useLayoutEffect, useMemo, useCallback, useState } from 'react';\r\nimport * as d3 from 'd3';\r\n// import { transition } from 'd3';\r\nimport useDimensions from \"react-cool-dimensions\";\r\nimport styled from 'styled-components';\r\nimport { useResizeDetector } from 'react-resize-detector';\r\nimport { transition } from 'd3';\r\nimport { useNetIncome } from '../utils/TaxCalculation';\r\nimport ScaleReference from './ScaleReference';\r\n\r\nimport { taxBrackets } from '../data/TaxBrackets';\r\nimport { theme } from '../theme';\r\n\r\n\r\n// const transitionDuration = 1000\r\n\r\nexport const TaxBracketDisplay = ({\r\n    barWidth,\r\n    scaleIncome,\r\n    scaleTaxRate,\r\n    showTax,\r\n    blinkTax,\r\n    netIncome,\r\n    // netIncomeMask,\r\n    enableTransition = true,\r\n    active = false,\r\n    transitionTime = 500,\r\n    isPullTax = false,\r\n    setPullTax = () => {},\r\n}) => {\r\n    const transitionDuration = useMemo(() => enableTransition ? transitionTime : 0, [enableTransition, transitionTime]);\r\n\r\n    const taxBracketRef = useRef(null);\r\n    const taxMaskRef = useRef(null);\r\n\r\n    const generateTaxBracketsPathD = useCallback(x => {\r\n        let pathD = 'M 0 0 ';\r\n        pathD += taxBrackets.map((d) => {\r\n            return ''\r\n                + `L ${scaleTaxRate(d.taxRate)} ${scaleIncome(d.minNetIncome)} `\r\n                + `L ${scaleTaxRate(d.taxRate)} ${scaleIncome(d.maxNetIncome)} `\r\n        }).join('')\r\n        pathD += `L 0 ${scaleIncome(taxBrackets[taxBrackets.length - 1].maxNetIncome)} `\r\n        pathD += `Z`\r\n        return pathD;\r\n    }, [scaleIncome, scaleTaxRate]);\r\n\r\n    useLayoutEffect(() => {\r\n        if (taxBracketRef.current && taxMaskRef.current) {\r\n\r\n            const g = d3.select(taxBracketRef.current);\r\n            const mask = d3.select(taxMaskRef.current);\r\n\r\n            mask.attr('width', barWidth)\r\n                .transition().duration(transitionDuration)\r\n                // .style('fill', '#08f')\r\n                .attr('height', Math.max(0, scaleIncome(netIncome)));\r\n\r\n            g.select('path.tax-stairs-camouflage')\r\n                .attr('fill', theme.colors.bg)\r\n                .transition().duration(transitionDuration)\r\n                .attr('opacity', showTax ? 1 : 0)\r\n                .attr('d', generateTaxBracketsPathD)\r\n\r\n            g.select('path.tax-stairs')\r\n                .attr('fill', theme.colors.tax)\r\n                .style('animation', showTax && blinkTax ? 'blink-from-none 1s infinite' : 'none')\r\n                .transition().duration(transitionDuration)\r\n                .attr('d', generateTaxBracketsPathD)\r\n                .attr('transform', isPullTax ? `translate(${-50}, 0)` : 'translate(0, 0)')\r\n                .style('opacity', showTax && !isPullTax ? 1 : 0)\r\n\r\n            const bracketLineGroups = g.select('g.tax-lines')\r\n                .selectAll('g')\r\n                .data(taxBrackets)\r\n\r\n            const bracketLineGroupsEnter = bracketLineGroups\r\n                .enter()\r\n                .append('g')\r\n                .classed('bracket', true)\r\n\r\n            bracketLineGroupsEnter.append('text').classed('bracket-rate-text', true)\r\n            bracketLineGroupsEnter.append('text').classed('bracket-min-text', true)\r\n            bracketLineGroupsEnter.append('rect').classed('bracket-rect', true)\r\n            bracketLineGroupsEnter.append('line').classed('bracket-line', true)\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('rect')\r\n                .attr('x', 0)   // d => scaleTaxRate(d.taxRate))\r\n                .attr('width', d => scaleTaxRate(d.taxRate))\r\n                .style('fill-opacity', 0)\r\n                .style('stroke', theme.colors.tax)\r\n                .style(\"stroke-dasharray\", \"3, 3\")\r\n                .transition().duration(transitionDuration)\r\n                .attr('y', d => scaleIncome(d.minNetIncome))\r\n                .attr('height', d => scaleIncome(d.maxNetIncome - d.minNetIncome))\r\n                .attr('opacity', active ? 1 : 0)\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('line')\r\n                .attr('x1', 0)\r\n                .attr('x2', barWidth)\r\n                .style('stroke', theme.colors.tax)\r\n                .style(\"stroke-dasharray\", \"3, 3\")\r\n                .transition().duration(transitionDuration)\r\n                // .style('stroke-opacity', '0.4')\r\n                .attr('y1', d => Math.round(scaleIncome(d.maxNetIncome)))\r\n                .attr('y2', d => Math.round(scaleIncome(d.maxNetIncome)))\r\n                .attr('opacity', active ? 1 : 0)\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('text.bracket-rate-text')\r\n                .style('fill', theme.colors.text)\r\n                .style('font-size', '0.75rem')\r\n                .style('text-anchor', 'end')\r\n                .attr('x', barWidth - 5)\r\n                .transition().duration(transitionDuration)\r\n                .text(d => `เริ่มคิดที่ ${d.minNetIncome.toLocaleString()} บาท`)\r\n                .style('fill-opacity', (d, i) => i != 0 && scaleIncome(d.maxNetIncome - d.minNetIncome) > 20 ? 1 : 0)\r\n                .attr('y', d => -scaleIncome(d.minNetIncome) - 5)\r\n                .attr('opacity', active ? 1 : 0)\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('text.bracket-min-text')\r\n                .style('fill', theme.colors.text)\r\n                .style('font-size', '0.75rem')\r\n                .attr('x', d => scaleTaxRate(d.taxRate) + 5)\r\n                .transition().duration(transitionDuration)\r\n                .text(d => `ภาษี ${d.taxRate * 100}%`)\r\n                // .text(d => scaleIncome(d.maxNetIncome - d.minNetIncome) > 150\r\n                //     ? `เริ่มคิดที่ ${numberWithCommas(d.minNetIncome)} บาท`\r\n                //     : `${d.taxRate * 100}%`)\r\n                .style('fill-opacity', (d, i) => i != 0 && scaleIncome(d.maxNetIncome - d.minNetIncome) > 20 ? 1 : 0)\r\n                .attr('y', d => -scaleIncome(d.minNetIncome) - 5)\r\n                .attr('opacity', active ? 1 : 0)\r\n        }\r\n    }, [\r\n        taxBracketRef,\r\n        taxMaskRef,\r\n        netIncome,\r\n        scaleTaxRate,\r\n        scaleIncome,\r\n        active,\r\n        showTax,\r\n        blinkTax,\r\n        barWidth,\r\n        generateTaxBracketsPathD,\r\n        isPullTax,\r\n        transitionDuration\r\n    ]);\r\n\r\n    return (<>\r\n        <defs>\r\n            <clipPath id=\"net-income-mask\">\r\n                <rect className=\"net-income-mask\" ref={taxMaskRef}/>\r\n            </clipPath>\r\n        </defs>\r\n        <g id=\"tax-brackets\" ref={taxBracketRef}>\r\n            <g className=\"tax-lines\" />\r\n            <path className=\"tax-stairs-camouflage\" clipPath={`url(#net-income-mask)`} onClick={() => setPullTax(false)} />\r\n            <path className=\"tax-stairs\" clipPath={`url(#net-income-mask)`} onClick={() => setPullTax(!isPullTax)} />\r\n        </g>\r\n    </>);\r\n}","import React, { useRef, useEffect, useLayoutEffect, useMemo, useCallback, useState } from 'react';\r\nimport * as d3 from 'd3';\r\n// import { transition } from 'd3';\r\nimport useDimensions from \"react-cool-dimensions\";\r\nimport styled from 'styled-components';\r\nimport { useResizeDetector } from 'react-resize-detector';\r\nimport { transition } from 'd3';\r\nimport { useNetIncome } from '../utils/TaxCalculation';\r\nimport ScaleReference from './ScaleReference';\r\n\r\nimport { taxBrackets } from '../data/TaxBrackets';\r\nimport { MoneyBlock } from './MoneyBlock';\r\nimport { TaxBracketDisplay } from './TaxBracketDisplay';\r\nimport { theme } from '../theme';\r\n\r\nconst SvgContainer = styled.div`\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n`\r\n\r\nconst CartesianSvg = styled.svg`\r\n    & > g text {\r\n        transform: scale(1, -1);\r\n    }\r\n`\r\n\r\n// const transitionDuration = 1000\r\n\r\nexport const D3Component = ({\r\n    incomeGroups,\r\n    // incomeGroupLabels,\r\n    // expenseGroups,\r\n    isGroupIncome,\r\n    showBreakdown,\r\n\r\n    income,\r\n    expense,\r\n    allowance,\r\n    // taxBrackets,\r\n    padding = {\r\n        left: 35,\r\n        right: 0,\r\n        top: 0,\r\n        bottom: 30,\r\n    },\r\n    isPullTax = false,\r\n    showBrackets = true,\r\n    isActivateTax = true,\r\n    setPullTax = (x) => { },\r\n    transitionTime = 500,\r\n    enableTransition = true,\r\n    isBlink = {}\r\n}) => {\r\n    const { observe, unobserve, width, height, entry } = useDimensions({\r\n        onResize: ({ observe, unobserve, width, height, entry }) => {\r\n            // Triggered whenever the size of the target is changed...\r\n\r\n            unobserve(); // To stop observing the current target element\r\n            observe(); // To re-start observing the current target element\r\n        },\r\n    });\r\n\r\n    const transitionDuration = useMemo(() => enableTransition ? transitionTime : 0, [enableTransition, transitionTime]);\r\n\r\n    const d3Container = useRef(null);\r\n\r\n    const cleanedExpense = useMemo(() => expense < (income - allowance) ? +expense : +Math.max(0, income - allowance), [income, expense]);\r\n    const cleanedAllowance = useMemo(() => Math.min(income, allowance), [income, allowance]);\r\n\r\n    const netIncome = useNetIncome(income, expense, allowance);\r\n\r\n    const scaleIncome = useCallback(\r\n        d3.scaleLinear()\r\n            .domain([0, Math.max(300_000, income * 1.4)])\r\n            .range([0, height - padding.bottom])\r\n        , [height, income, padding])\r\n\r\n    const barWidth = useMemo(() => width - (padding.left + padding.right), [width, padding]);\r\n\r\n    const scaleTaxRate = useCallback(\r\n        d3.scaleLinear()\r\n            .domain([0, 1])\r\n            .range([0, barWidth])\r\n        , [income, width])\r\n\r\n    const axisIncome = useMemo(() => d3.axisLeft(scaleIncome)\r\n        .tickFormat(d3.format(\".3s\"))\r\n        , [scaleIncome]);\r\n    const axisTaxRate = useMemo(() => d3.axisBottom(scaleTaxRate).tickFormat(d3.format('.0%'))\r\n        , [scaleTaxRate]);    \r\n\r\n    useLayoutEffect(() => {\r\n        if (d3Container.current) {\r\n\r\n            const svg = d3.select(d3Container.current);\r\n\r\n            svg.select('g.container')\r\n                .attr('transform', `translate(${padding.left}, ${padding.bottom})`);\r\n\r\n            svg.select('g.overview')\r\n                .transition().duration(transitionDuration)\r\n                .attr('opacity', showBreakdown ? 0 : 1)\r\n\r\n            svg.select('g.breakdown')\r\n                .transition().duration(transitionDuration)\r\n                .attr('opacity', showBreakdown ? 1 : 0)\r\n\r\n            // AXES\r\n\r\n            d3.select(\"g.axis-income\")\r\n                .attr(\"transform\", `translate(0, 0)`)\r\n                .transition().duration(transitionDuration)\r\n                .call(axisIncome);\r\n\r\n            d3.select(\"g.axis-tax-rate\")\r\n                // .attr(\"transform\", `translate(-10, 0)`)\r\n                .transition().duration(transitionDuration)\r\n                .call(axisTaxRate);\r\n        }\r\n    }, [\r\n        d3Container,\r\n        padding,\r\n        axisIncome,\r\n        axisTaxRate,\r\n        showBreakdown,\r\n        transitionDuration,\r\n    ]);\r\n\r\n    const sum = x => x.reduce((a, b) => a + b, 0);\r\n\r\n    return (<>\r\n        <SvgContainer ref={observe}>\r\n            {/* <Fade /> */}\r\n            <CartesianSvg\r\n                id=\"chart\"\r\n                className=\"d3-component\"\r\n                width={width}\r\n                height={height}\r\n                ref={d3Container}\r\n            >\r\n                <defs>\r\n                    <linearGradient id=\"fade-grad\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\r\n                        <stop offset=\"0%\" style={{ stopColor: theme.colors.bg, stopOpacity: 1 }} />\r\n                        <stop offset=\"100%\" style={{ stopColor: theme.colors.bg, stopOpacity: 0 }} />\r\n                    </linearGradient>\r\n                </defs>\r\n\r\n                <g transform={`translate(0, ${height}) scale(1, -1)`}>\r\n                    <g className=\"container\">\r\n                        <g className=\"overview\">\r\n                            <MoneyBlock amount={netIncome} scale={scaleIncome} offset={0} barWidth={barWidth} fill={theme.colors.income} label='เงินได้สุทธิ' stroke={false} enableTransition={enableTransition} isBlink={isBlink.income}/>\r\n                            <MoneyBlock amount={cleanedExpense} scale={scaleIncome} offset={netIncome + cleanedAllowance} barWidth={barWidth} fill={theme.colors.expense} label='ค่าใช้จ่าย' stroke={false} enableTransition={enableTransition}/>\r\n                            <MoneyBlock amount={cleanedAllowance} scale={scaleIncome} offset={netIncome} barWidth={barWidth} fill={theme.colors.allowance} label='ค่าลดหย่อน' stroke={false} enableTransition={enableTransition}/>\r\n                        </g>\r\n                        <g className=\"breakdown\">\r\n                            {incomeGroups.map((ig, i) => <>\r\n                                <MoneyBlock\r\n                                    amount={ig.income - ig.expense}\r\n                                    scale={scaleIncome}\r\n                                    offset={\r\n                                        isGroupIncome\r\n                                            ? sum(incomeGroups.slice(0, i).map(x => x.income - x.expense))\r\n                                            : sum(incomeGroups.slice(0, i).map(x => x.income))\r\n                                    }\r\n                                    barWidth={barWidth}\r\n                                    fill={theme.colors.income}\r\n                                    label={ig.label}\r\n                                    stroke={true} />\r\n                                <MoneyBlock\r\n                                    amount={ig.expense}\r\n                                    scale={scaleIncome}\r\n                                    offset={\r\n                                        isGroupIncome\r\n                                            ? sum(incomeGroups.map(x => x.income - x.expense)) + sum(incomeGroups.slice(0, i).map(x => x.expense))\r\n                                            : sum(incomeGroups.slice(0, i).map(x => x.income)) + (ig.income - +ig.expense)\r\n                                    }\r\n                                    barWidth={barWidth}\r\n                                    fill={theme.colors.expense}\r\n                                    label={'ค่าใช้จ่าย คิดจาก' + ig.label}\r\n                                    stroke={true} />\r\n                            </>)}\r\n                        </g>\r\n\r\n                        <TaxBracketDisplay \r\n                            barWidth={barWidth}\r\n                            scaleIncome={scaleIncome}\r\n                            scaleTaxRate={scaleTaxRate}\r\n                            showTax={isActivateTax}\r\n                            blinkTax={isBlink.tax}\r\n                            active={showBrackets}\r\n                            netIncome={netIncome}\r\n                        />\r\n\r\n                        <g className=\"axis axis-income\" />\r\n                        <g className=\"axis axis-tax-rate\" />\r\n                    </g>\r\n                </g>\r\n                <rect className=\"fade\" fill=\"url(#fade-grad)\" width={width} height={(height - padding.bottom) * 0.25} />\r\n                <ScaleReference scale={scaleIncome} barWidth={barWidth} x={width} y={40 / 2} maxSize={40} />\r\n            </CartesianSvg>\r\n        </SvgContainer>\r\n    </>);\r\n}","import React, { useMemo } from 'react';\r\nimport styled from 'styled-components';\r\nimport * as d3 from 'd3'\r\n\r\nconst StoryIndicatorContainer = styled.div`\r\n    display: flex;\r\n    gap: 4px;\r\n    position: absolute;\r\n    top: 15px;\r\n    left: 30px;\r\n    right: 30px;\r\n    z-index: 100;\r\n\r\n    @media (min-width: 480px) {\r\n        width: 500px;\r\n        margin: auto;\r\n    }\r\n`\r\n\r\nconst StoryIndicatorItem = styled.div`\r\n    height: 2px;\r\n    flex-grow: 1;\r\n    border-radius: 999;\r\n    background-color: #fff;\r\n    transition: opacity 0.2s;\r\n    opacity: ${props => props.active ? 1 : 0.2};\r\n`\r\n\r\nconst StoryIndicator = ({ currentStep = 0, totalSteps = 0, ...props }) => {\r\n    const steps = useMemo(() => d3.range(totalSteps), [totalSteps]);\r\n\r\n    return (\r\n        <>\r\n            <StoryIndicatorContainer {...props}>\r\n                {steps.map((d, i) => (\r\n                    <StoryIndicatorItem active={i <= currentStep} />\r\n                ))}\r\n            </StoryIndicatorContainer>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default StoryIndicator;","import React, { useCallback, useEffect, useRef, useState } from 'react';\r\nimport styled from 'styled-components';\r\nimport { theme } from '../theme';\r\nimport { transparentize } from 'polished';\r\n\r\nconst FadeTop = styled.div`\r\n    position: absolute;\r\n    top: -2px;\r\n    left: -2px;\r\n    right: -2px;\r\n    height: 50px;\r\n    background: linear-gradient(to bottom, ${theme.colors.bg}, ${transparentize(1, theme.colors.bg)});\r\n    pointer-events: none;\r\n    z-index: 1;\r\n\r\n    transition: all 0.2s;\r\n    opacity: ${props => props.active ? 1 : 0};\r\n`\r\n\r\nconst FadeBottom = styled.div`\r\n    position: absolute;\r\n    bottom: -2px;\r\n    left: -2px;\r\n    right: -2px;\r\n    height: 50px;\r\n    background: linear-gradient(to top, ${theme.colors.bg}, ${transparentize(1, theme.colors.bg)});\r\n    pointer-events: none;\r\n    z-index: 1;\r\n\r\n    transition: all 0.2s;\r\n    opacity: ${props => props.active ? 1 : 0};\r\n`\r\n\r\nconst ScrollBoxContainer = styled.div`\r\n    /* position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0; */\r\n    position: relative;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n`\r\n\r\nconst StyledScrollBox = styled.div`\r\n    position: relative;\r\n    flex-grow: 1;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n`\r\n\r\nconst ScrollBox = ({ children, onScroll, ...props }) => {\r\n    const scrollBoxRef = useRef(null);\r\n    const [showTopFade, setShowTopFade] = useState(true);\r\n    const [showBottomFade, setShowBottomFade] = useState(true);\r\n\r\n    const handleScroll = useCallback((e) => {\r\n        if (scrollBoxRef.current) {\r\n            setShowTopFade(scrollBoxRef.current.scrollTop > 0);\r\n            setShowBottomFade(scrollBoxRef.current.offsetHeight + scrollBoxRef.current.scrollTop < scrollBoxRef.current.scrollHeight);\r\n        }\r\n    }, [scrollBoxRef]);\r\n\r\n    useEffect(() => {\r\n        if (scrollBoxRef.current) {\r\n            console.log('registering handleScroll', handleScroll);\r\n            scrollBoxRef.current.addEventListener('scroll', (e) => {\r\n                onScroll(e);\r\n                handleScroll(e);\r\n            });\r\n            return () => {\r\n                if (scrollBoxRef.current)\r\n                    scrollBoxRef.current.removeEventListener('scroll', handleScroll);\r\n            }\r\n        }\r\n    }, [scrollBoxRef, handleScroll])\r\n\r\n    useEffect(handleScroll, [scrollBoxRef]);\r\n\r\n    return (\r\n        <>\r\n            <StyledScrollBox ref={scrollBoxRef} {...props}>\r\n                {children}\r\n            </StyledScrollBox>\r\n            <FadeTop active={showTopFade} />\r\n            <FadeBottom active={showBottomFade} />\r\n        </>\r\n    );\r\n}\r\n\r\nexport default ScrollBox;\r\n\r\n","import styled from 'styled-components';\r\nimport ReactSlider from 'react-slider';\r\nimport { useState } from 'react';\r\nimport { darken, lighten } from 'polished';\r\n\r\nconst StyledSlider = styled(ReactSlider)`\r\n    width: 100%;\r\n    height: 20px;\r\n`;\r\n\r\nconst StyledThumb = styled.div`\r\n    height: 20px;\r\n    line-height: 20px;\r\n    width: 20px;\r\n    text-align: center;\r\n    background-color: ${props => props.color || '#08f'};\r\n    /* border: 2px ${props =>  darken(0.1, props.color || '#08f')} solid; */\r\n    box-sizing: border-box;\r\n    color: #fff;\r\n    border-radius: 12px;\r\n    cursor: grab;\r\n    position: relative;\r\n`;\r\n\r\nconst StyledTrack = styled.div`\r\n    top: 6px;\r\n    bottom: 6px;\r\n    background: ${props => props.index === 1 ? '#fff3' : darken(0.15, props.color || '#08f')};\r\n    border-radius: 999px;\r\n`;\r\n\r\nconst Tooltip = styled.div`\r\n    opacity: ${props => props.visible ? 1 : 0};\r\n    position: absolute;\r\n    top: -40px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: #000d;\r\n    padding: 4px 8px;\r\n    border-radius: 4px;\r\n    transition: all 0.2s;\r\n    font-size: 0.75rem;\r\n    pointer-events: none;\r\n`;\r\n\r\nconst Slider = ({ onBeforeChange = () => { }, onAfterChange = () => { }, color, ...props }) => {\r\n    const [showTooltip, setShowTooltip] = useState(false);\r\n    return <StyledSlider\r\n        renderTrack={(props, state) => <StyledTrack {...props} index={state.index} color={color}/>}\r\n        renderThumb={(props, state) => <StyledThumb {...props} color={color}>\r\n            <Tooltip visible={showTooltip}>{state.valueNow.toLocaleString()}</Tooltip>\r\n        </StyledThumb>}\r\n        onBeforeChange={(x) => {\r\n            setShowTooltip(true)\r\n            onBeforeChange(x);\r\n        }}\r\n        onAfterChange={(x) => {\r\n            setShowTooltip(false)\r\n            onAfterChange(x);\r\n        }}\r\n        {...props}\r\n    />\r\n}\r\n\r\nexport default Slider;","import React from 'react';\r\nimport styled, { keyframes, css } from 'styled-components';\r\n\r\nconst scrollPreview = keyframes`\r\n  0% {\r\n    opacity: 0;\r\n    transform: translate(-50%, 100px);\r\n  }\r\n\r\n  20% {\r\n    opacity: 1;\r\n    transform: translate(-50%, 100px);\r\n  }\r\n\r\n  80% {\r\n    opacity: 1;\r\n    transform: translate(-50%, 0);\r\n  }\r\n\r\n  100% {\r\n    opacity: 0;\r\n    transform: translate(-50%, 0);\r\n  }\r\n`\r\n\r\nconst ScrollInstruction = styled.div`\r\n    width: 64px;\r\n    height: 64px;\r\n    background-color: #fff;\r\n    position: absolute;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    ${props => props.visible && css`animation: ${scrollPreview} 2s infinite`};\r\n    background: url('${process.env.PUBLIC_URL}/drag.svg');\r\n    background-size: cover;\r\n    opacity: ${props => props.visible ? 1 : 0};\r\n    \r\n    transition: all 0.2s;\r\n`\r\n\r\n// const ScrollInstruction = ({ ...props }) =>\r\n// <StyledScrollInstruction {...props} />\r\n\r\nexport default ScrollInstruction;","import { useEffect, useMemo, useState } from \"react\";\r\nimport { D3Component } from \"./components/D3Component\";\r\nimport styled, { css } from \"styled-components\";\r\nimport \"./App.css\";\r\nimport { numberWithCommas } from \"./utils/display\";\r\nimport { useNetIncome, useTaxCalculation } from \"./utils/TaxCalculation\";\r\nimport StoryIndicator from \"./components/StoryIndicator\";\r\nimport ScrollBox from \"./components/ScrollBox\";\r\nimport Slider from './components/Slider';\r\nimport ScrollInstruction from './components/ScrollInstruction';\r\n\r\nimport { taxBrackets } from \"./data/TaxBrackets\";\r\nimport { theme } from \"./theme\";\r\n\r\nconst ChartContainer = styled.div`\r\n  /* padding: 30px; */\r\n  width: 100%;\r\n  margin-top: 10px;\r\n  /* height: 50vh; */\r\n  flex: 1;\r\n  position: relative;\r\n  transition: all 0.2s;\r\n`;\r\n\r\nconst SideContainer = styled.div`\r\n  height: 220px;\r\n  /* overflow-y: auto; */\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: flex-end;\r\n\r\n  @media (min-width: 480px) {\r\n    height: auto;\r\n    margin-left: 80px;\r\n    width: 40%;\r\n    min-width: 300px;\r\n    max-width: 400px;\r\n    justify-content: center;\r\n  }\r\n`;\r\n\r\nconst Step = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  flex-grow: 1;\r\n  transition: all 0.5s;\r\n\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n\r\n  ${(props) => {\r\n    switch (props.status) {\r\n      case -1:\r\n        return css`\r\n          transform: translateX(-100px);\r\n          opacity: 0;\r\n          pointer-events: none;\r\n        `;\r\n        break;\r\n      case 1:\r\n        return css`\r\n          transform: translateX(100px);\r\n          opacity: 0;\r\n          pointer-events: none;\r\n        `;\r\n        break;\r\n      default:\r\n        return css`\r\n          /* transform: translateX(-100px):  */\r\n          /* opacity: 0; */\r\n          /* pointer-events: none; */\r\n        `;\r\n        break;\r\n    }\r\n  }}\r\n`;\r\n\r\nconst StepOnly = styled.div`\r\n  ${(props) => {\r\n    switch (props.status) {\r\n      case -1:\r\n        return css`\r\n          transform: translateX(-100px);\r\n          opacity: 0;\r\n          pointer-events: none;\r\n        `;\r\n        break;\r\n      case 1:\r\n        return css`\r\n          transform: translateX(100px);\r\n          opacity: 0;\r\n          pointer-events: none;\r\n        `;\r\n        break;\r\n      default:\r\n        return css`\r\n          /* transform: translateX(-100px):  */\r\n          /* opacity: 0; */\r\n          /* pointer-events: none; */\r\n        `;\r\n        break;\r\n    }\r\n  }}\r\n`;\r\n\r\nconst ContentContainer = styled.div`\r\n  /* height: 200px; */\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  flex-grow: 1;\r\n  position: relative;\r\n\r\n  @media (min-width: 480px) {\r\n    min-height: 240px;\r\n    flex-grow: 0;\r\n  }\r\n`;\r\n\r\nconst PageContainer = styled.div`\r\n  padding: 30px;\r\n  /* padding-top: 15px; */\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  gap: 10px;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n\r\n  @media (min-width: 480px) {\r\n    flex-direction: row;\r\n    padding: 50px;\r\n  }\r\n`;\r\n\r\nconst ControlsContainer = styled.div`\r\n  /* margin-top: 30px; */\r\n  display: flex;\r\n  /* grid-template-columns: auto auto 80px; */\r\n  /* column-gap: 10px; */\r\n  /* row-gap: 15px; */\r\n  gap: 0.5rem;\r\n  flex-direction: column;\r\n  /* margin-bottom: 30px; */\r\n  align-content: center;\r\n\r\n  label {\r\n    white-space: nowrap;\r\n  }\r\n`;\r\n\r\nconst ControlsGrid = styled.div`\r\n  /* margin-top: 30px; */\r\n  display: grid;\r\n  grid-template-columns: auto auto 80px;\r\n  column-gap: 10px;\r\n  row-gap: 5px;\r\n  /* margin-bottom: 30px; */\r\n  align-content: center;\r\n\r\n  label {\r\n    white-space: nowrap;\r\n  }\r\n`;\r\n\r\nconst InputGroup = styled.div`\r\n  /* margin-bottom: 10px; */\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst Button = styled.button`\r\n  border: none;\r\n  border-radius: 4px;\r\n  padding: 4px 8px;\r\n  font-family: \"Bai Jamjuree\", sans-serif;\r\n\r\n  ${(props) =>\r\n    props.secondary\r\n      ? css`\r\n          border: 1px white solid;\r\n          background-color: transparent;\r\n          color: white;\r\n        `\r\n      : css`\r\n          background-color: white;\r\n        `}\r\n\r\n  ${(props) =>\r\n    props.disabled &&\r\n    css`\r\n      opacity: 0.4;\r\n    `}\r\n`;\r\n\r\nfunction NetIncomeEquation({ income, expense, allowance, highlight = {} }) {\r\n  const netIncome = useNetIncome(income, expense, allowance);\r\n  return (\r\n    <div style={{ display: \"flex\", alignItems: \"center\", marginTop: \"20px\" }}>\r\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n        <small\r\n          style={{\r\n            color: highlight.income\r\n              ? theme.colors.incomeText\r\n              : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          รายได้\r\n        </small>\r\n        <br />\r\n        <small\r\n          style={{\r\n            fontWeight: highlight.income ? \"bold\" : \"normal\",\r\n            color: highlight.income\r\n              ? theme.colors.text\r\n              : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          {Math.round(income).toLocaleString()}\r\n        </small>\r\n      </div>\r\n      <div style={{ color: theme.colors.textMuted }}>−</div>\r\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n        <small\r\n          style={{\r\n            color: highlight.expense\r\n              ? theme.colors.expenseText\r\n              : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          ค่าใช้จ่าย\r\n        </small>\r\n        <br />\r\n        <small\r\n          style={{\r\n            fontWeight: highlight.expense ? \"bold\" : \"normal\",\r\n            color: highlight.expense\r\n              ? theme.colors.text\r\n              : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          {Math.round(expense).toLocaleString()}\r\n        </small>\r\n      </div>\r\n      <div style={{ color: theme.colors.textMuted }}>−</div>\r\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n        <small\r\n          style={{\r\n            color: highlight.allowance\r\n              ? theme.colors.allowanceText\r\n              : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          ลดหย่อน\r\n        </small>\r\n        <br />\r\n        <small\r\n          style={{\r\n            fontWeight: highlight.allowance ? \"bold\" : \"normal\",\r\n            color: highlight.allowance\r\n              ? theme.colors.text\r\n              : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          {Math.round(allowance).toLocaleString()}\r\n        </small>\r\n      </div>\r\n      <div style={{ color: theme.colors.textMuted }}>=</div>\r\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n        <small\r\n          style={{\r\n            color: highlight.netIncome\r\n              ? theme.colors.incomeText\r\n              : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          เงินได้สุทธิ\r\n        </small>\r\n        <br />\r\n        <small\r\n          style={{\r\n            fontWeight: highlight.netIncome ? \"bold\" : \"normal\",\r\n            color: highlight.netIncome\r\n              ? theme.colors.text\r\n              : theme.colors.textMuted,\r\n          }}\r\n        >\r\n          {Math.round(netIncome).toLocaleString()}\r\n        </small>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction App() {\r\n  // income stated & computed numbers\r\n  const [salary, setSalary] = useState(0);\r\n  const [incomeFreelance, setIncomeFreelance] = useState(0);\r\n  const [incomeMerchant, setIncomeMerchant] = useState(0);\r\n  const [enableIncome, setEnableIncome] = useState(false);\r\n  const salaryDisplay = useMemo(() => (enableIncome ? salary : 0), [\r\n    enableIncome,\r\n    salary,\r\n  ]);\r\n  const incomeFreelanceDisplay = useMemo(\r\n    () => (enableIncome ? incomeFreelance : 0),\r\n    [enableIncome, incomeFreelance]\r\n  );\r\n  const incomeMerchantDisplay = useMemo(\r\n    () => (enableIncome ? incomeMerchant : 0),\r\n    [enableIncome, incomeMerchant]\r\n  );\r\n  const income = useMemo(\r\n    () =>\r\n      (+salaryDisplay + +incomeFreelanceDisplay + +incomeMerchantDisplay: 0),\r\n    [salaryDisplay, incomeMerchantDisplay, incomeFreelanceDisplay]\r\n  );\r\n\r\n  // salary input\r\n  const [salarySlider, setSalarySlider] = useState(0);\r\n  // useEffect(() => setSalary(Math.pow(10, salarySlider)), [salarySlider])\r\n  // useEffect(() => setSalary(Math.pow(10, salarySlider)), [salarySlider])\r\n\r\n  // expense stated & computed numbers\r\n  const [enableExpense, setEnableExpense] = useState(false);\r\n  const expense40_1_2 = useMemo(\r\n    () =>\r\n      enableExpense ? Math.min((+salary + +incomeFreelance) * 0.5, 100_000) : 0,\r\n    [salary, incomeFreelance, enableExpense]\r\n  );\r\n  const expense40_8 = useMemo(\r\n    () => (enableExpense ? incomeMerchant * 0.6 : 0),\r\n    [incomeMerchant, enableExpense]\r\n  );\r\n  const expense = useMemo(\r\n    () => (enableExpense ? +expense40_1_2 + +expense40_8 : 0),\r\n    [expense40_1_2, expense40_8, enableExpense]\r\n  );\r\n\r\n  // allowance stated & computed numbers\r\n  const [enableAllowance, setEnableAllowance] = useState(false);\r\n  const [allowance, setAllowance] = useState(60_000);\r\n  const allowanceDisplay = useMemo(() => (enableAllowance ? allowance : 0), [\r\n    allowance,\r\n    enableAllowance,\r\n  ]);\r\n\r\n  const [isGroupIncome, setGroupIncome] = useState(false);\r\n\r\n  const netIncome = useNetIncome(income, expense, allowanceDisplay);\r\n  const taxFinal = useTaxCalculation(netIncome, taxBrackets);\r\n\r\n  const [enableTransition, setEnableTransition] = useState(true);\r\n  const [currentNarrativeStep, setCurrentNarrativeStep] = useState(-1);\r\n\r\n  // display parameters\r\n  const [isPullTax, setPullTax] = useState(false);\r\n  const [isActivateTax, setActivateTax] = useState(false);\r\n  const [showBrackets, setShowBrackets] = useState(false);\r\n  const [showBreakdown, setShowBreakdown] = useState(true);\r\n  const [showDragInstruction, setShowDragInstruction] = useState(true);\r\n\r\n  const narrativeSteps = [\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>\r\n        \"\r\n        <span style={{ color: theme.colors.taxText }}>\r\n          ภาษีเงินได้บุคคลธรรมดา\r\n        </span>\r\n        \" คิดจาก \"\r\n        <span style={{ color: theme.colors.incomeText }}>เงินได้สุทธิ</span>\"\r\n        ซึ่งคำนวณจากรายได้ของเราหลังจากหักค่าใช้จ่ายแล้ว\r\n      </p>\r\n      <div style={{ display: \"flex\", alignItems: \"center\" }}>\r\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n          <span style={{ color: theme.colors.incomeText }}>เงินได้สุทธิ</span>\r\n        </div>\r\n        <div>=</div>\r\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n          <span>รายได้</span>\r\n        </div>\r\n        <div>−</div>\r\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n          <span>ค่าใช้จ่าย</span>\r\n        </div>\r\n        <div>−</div>\r\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\r\n          <span>ค่าลดหย่อน</span>\r\n        </div>\r\n\r\n        {/* <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small>ภาษี</small>\r\n          <br />\r\n          <b>{numberWithCommas(Math.ceil(taxFinal))} </b>\r\n        </div> */}\r\n      </div>\r\n    </>,\r\n\r\n    <>\r\n      <ControlsContainer>\r\n        <div style={{ display: \"flex\" }}>\r\n          <label style={{ flexGrow: 1 }}>เงินเดือน (ทั้งปี รวมโบนัส)</label>\r\n          <input\r\n            type=\"number\"\r\n            step={10_000}\r\n            min={0}\r\n            value={salary}\r\n            onChange={(e) => setSalary(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n        \r\n        <Slider\r\n          min={0}\r\n          max={1_200_000}\r\n          step={10_000}\r\n          value={salary}\r\n          onAfterChange={setSalary}\r\n          color={theme.colors.incomeText}\r\n        />\r\n      </ControlsContainer>\r\n      {/* <small style={{ marginLeft: \"auto\", color: theme.colors.textMuted }}>\r\n        เงินเดือน &times; 12 = {numberWithCommas(income)} บาท/ปี\r\n      </small> */}\r\n      <NetIncomeEquation\r\n        income={income}\r\n        expense={expense}\r\n        allowance={allowanceDisplay}\r\n        highlight={{ income: true }}\r\n      />\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>\r\n        มีรายได้จากฟรีแลนซ์/ขายของด้วยหรือเปล่า?\r\n      </p>\r\n      <ControlsGrid style={{gridTemplateColumns: '80px auto 80px'}}>\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>\r\n            ฟรีแลนซ์ <span style={{ color: theme.colors.textMuted }}>/ ปี</span>\r\n          </small>\r\n        </label>\r\n        <Slider\r\n          min={0}\r\n          max={1_200_000}\r\n          step={10_000}\r\n          value={incomeFreelance}\r\n          onAfterChange={setIncomeFreelance}\r\n          color={theme.colors.incomeText}\r\n        />\r\n        <div>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={incomeFreelance}\r\n            onChange={(e) => setIncomeFreelance(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>\r\n            ขายของ <span style={{ color: theme.colors.textMuted }}>/ ปี</span>\r\n          </small>\r\n        </label>\r\n        <Slider\r\n          min={0}\r\n          max={1_200_000}\r\n          step={10_000}\r\n          value={incomeMerchant}\r\n          onAfterChange={setIncomeMerchant}\r\n          color={theme.colors.incomeText}\r\n        />\r\n        <div>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={incomeMerchant}\r\n            onChange={(e) => setIncomeMerchant(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n      </ControlsGrid>\r\n      <NetIncomeEquation\r\n        income={income}\r\n        expense={expense}\r\n        allowance={allowanceDisplay}\r\n        highlight={{ income: true }}\r\n      />\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>\r\n        <span style={{ color: theme.colors.expenseText }}>ค่าใช้จ่าย</span>\r\n        ที่หักได้ คิดจาก\r\n        <span style={{ color: theme.colors.incomeText }}>รายได้</span>\r\n        แต่ละประเภท\r\n      </p>\r\n      <p\r\n        style={{\r\n          display: \"grid\",\r\n          gridTemplateColumns: \"auto auto\",\r\n          columnGap: \"10px\",\r\n          marginBottom: 0,\r\n        }}\r\n      >\r\n        <span style={{ textAlign: \"right\" }}>เงินเดือน</span>\r\n        <span>นับเป็น \"เงินได้ประเภทที่ 1\"</span>\r\n        <span style={{ textAlign: \"right\" }}>เงินจากฟรีแลนซ์</span>\r\n        <span>นับเป็น \"เงินได้ประเภทที่ 2\"</span>\r\n        <span style={{ textAlign: \"right\" }}>เงินจากขายของ</span>\r\n        <span>นับเป็น \"เงินได้ประเภทที่ 8\"</span>\r\n      </p>\r\n      {/* <p style={{ textAlign: \"center\", color: theme.colors.textMuted }}>\r\n        *ตามประมวลรัษฎากร มาตรา 40\r\n      </p> */}\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>\r\n        แล้วหัก\r\n        <span style={{ color: theme.colors.expenseText }}>ค่าใช้จ่าย</span>\r\n        ได้เท่าไหร่ล่ะ?\r\n      </p>\r\n      <div\r\n        style={{\r\n          display: \"grid\",\r\n          gridTemplateColumns: \"auto auto\",\r\n          columnGap: \"10px\",\r\n          rowGap: \"10px\",\r\n        }}\r\n      >\r\n        <span style={{ textAlign: \"right\" }}>\r\n          เงินเดือน {incomeFreelance > 0 && \"+ ฟรีแลนซ์\"}\r\n        </span>\r\n        <span>\r\n          หักได้ 50% ของรายได้\r\n          <br />\r\n          (ไม่เกิน 100,000 บาท)\r\n        </span>\r\n        {incomeMerchant > 0 && (\r\n          <>\r\n            <span style={{ textAlign: \"right\" }}>ขายของ</span>\r\n            <span>หักได้อย่างน้อย 60%</span>\r\n          </>\r\n        )}\r\n      </div>\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\", marginBottom: 0 }}>\r\n        ดังนั้น คุณจะหัก\r\n        <span style={{ color: theme.colors.text }}>ค่าใช้จ่าย</span>ได้รวม\r\n        <br />\r\n        <b style={{ color: theme.colors.expenseText }}>\r\n          {Math.round(expense).toLocaleString()}\r\n        </b>{\" \"}\r\n        บาท\r\n      </p>\r\n      <NetIncomeEquation\r\n        income={income}\r\n        expense={expense}\r\n        allowance={allowanceDisplay}\r\n        highlight={{ expense: true }}\r\n      />\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>\r\n        นอกจาก\r\n        <span style={{ color: theme.colors.expenseText }}>ค่าใช้จ่าย</span>แล้ว\r\n        ทุกคน\r\n        <br />\r\n        สามารถหัก \"\r\n        <span style={{ color: theme.colors.allowanceText }}>\r\n          ค่าลดหย่อนส่วนตัว\r\n        </span>\r\n        \"\r\n        <br />\r\n        ได้ทันทีอีก 60,000 บาท!\r\n      </p>\r\n      <p style={{ textAlign: \"center\", marginBottom: 0 }}>\r\n        และ<span style={{ color: theme.colors.allowanceText }}>ค่าลดหย่อน</span>\r\n        ก็มาจากสิ่งอื่นๆ ได้อีก\r\n        <br />\r\n        เช่น การบริจาคเงิน ค่าเบี้ยประกันต่างๆ ฯลฯ\r\n      </p>\r\n    </>,\r\n\r\n    <>\r\n      {/* <p>ลดหย่อนส่วนตัวได้ 60,000 บาท</p> */}\r\n      <ControlsContainer>\r\n        <div style={{ display: \"flex\" }}>\r\n          <label style={{ flexGrow: 1 }}>ค่าลดหย่อน</label>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={allowance}\r\n            onChange={(e) => setAllowance(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n        <Slider\r\n          min={60_000}\r\n          max={1_200_000}\r\n          step={10_000}\r\n          value={allowance}\r\n          onAfterChange={setAllowance}\r\n          color={theme.colors.allowanceText}\r\n        />\r\n      </ControlsContainer>\r\n      <small style={{ marginLeft: \"auto\", color: theme.colors.textMuted }}>\r\n        ลดหย่อนส่วนตัวได้ 60,000 บาท\r\n      </small>\r\n      <NetIncomeEquation\r\n        income={income}\r\n        expense={expense}\r\n        allowance={allowanceDisplay}\r\n        highlight={{ allowance: true }}\r\n      />\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\", marginBottom: 0 }}>\r\n        ดังนั้น \"<span style={{ color: theme.colors.text }}>เงินได้สุทธิ</span>\"\r\n        ของคุณคือ\r\n        <br />\r\n        <b style={{ color: theme.colors.incomeText }}>\r\n          {Math.round(netIncome).toLocaleString()}\r\n        </b>{\" \"}\r\n        บาท\r\n      </p>\r\n      <NetIncomeEquation\r\n        income={income}\r\n        expense={expense}\r\n        allowance={allowanceDisplay}\r\n        highlight={{ netIncome: true }}\r\n      />\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\", marginBottom: 0 }}>\r\n        เมื่อคำนวณ \"\r\n        <span style={{ color: theme.colors.incomeText }}>เงินได้สุทธิ</span>\"\r\n        ได้แล้ว\r\n        <br />\r\n        จะต้องนำตัวเลขที่ได้ไปเข้า \"\r\n        <span style={{ color: theme.colors.taxText }}>ขั้นบันไดภาษี</span>\"\r\n        <br />\r\n        เพื่อคำนวณภาษีที่จะต้องจ่าย\r\n      </p>\r\n    </>,\r\n\r\n    <>\r\n      <p style={{ textAlign: \"center\" }}>\r\n        ดังนั้น{\" \"}\r\n        <span style={{ color: theme.colors.text }}>ภาษีเงินได้บุคคลธรรมดา</span>\r\n        <br />\r\n        ที่คุณจะต้องเสียคือ{\" \"}\r\n        <b style={{ color: theme.colors.taxText }}>\r\n          {Math.ceil(taxFinal).toLocaleString()}\r\n        </b>{\" \"}\r\n        บาท\r\n      </p>\r\n      <div style={{ display: \"flex\", alignItems: \"center\" }}>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.textMuted }}>รายได้</small>\r\n          <br />\r\n          <span style={{ color: theme.colors.textMuted }}>\r\n            {income.toLocaleString()}\r\n          </span>\r\n        </div>\r\n        <div style={{ color: theme.colors.textMuted }}>→</div>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.textMuted }}>เงินได้สุทธิ</small>\r\n          <br />\r\n          <span style={{ color: theme.colors.textMuted }}>\r\n            {netIncome.toLocaleString()}\r\n          </span>\r\n        </div>\r\n        <div style={{ color: theme.colors.textMuted }}>→</div>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.taxText }}>ภาษี</small>\r\n          <br />\r\n          <b>{Math.ceil(taxFinal).toLocaleString()} </b>\r\n        </div>\r\n      </div>\r\n    </>,\r\n\r\n    <ScrollBox style={{ height: \"500px\" }} onScroll={() => {\r\n      setShowDragInstruction(false);\r\n    }}>\r\n      <ScrollInstruction visible={showDragInstruction}/>\r\n      <p style={{ marginBottom: \"0.5rem\" }}>\r\n        <b>ลองปรับตัวเลขดู</b>\r\n      </p>\r\n      <div\r\n        style={{\r\n          margin: \"1rem  0 0.5rem\",\r\n          fontWeight: \"bold\",\r\n          color: theme.colors.incomeText,\r\n          display: \"flex\",\r\n        }}\r\n      >\r\n        <div style={{ flexGrow: 1 }}>รายได้</div>\r\n        <div>{income.toLocaleString()} บาท</div>\r\n      </div>\r\n      <ControlsGrid style={{gridTemplateColumns: '80px auto 80px'}}>\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>เงินเดือน</small>\r\n        </label>\r\n        <Slider\r\n          min={60_000}\r\n          max={1_200_000}\r\n          step={10_000}\r\n          value={salary}\r\n          onAfterChange={setSalary}\r\n          color={theme.colors.incomeText}\r\n        />\r\n        <div>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={salary}\r\n            onChange={(e) => setSalary(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>ฟรีแลนซ์</small>\r\n        </label>\r\n        <Slider\r\n          min={60_000}\r\n          max={1_200_000}\r\n          step={10_000}\r\n          value={incomeFreelance}\r\n          onAfterChange={setIncomeFreelance}\r\n          color={theme.colors.incomeText}\r\n        />\r\n        <div>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={incomeFreelance}\r\n            onChange={(e) => setIncomeFreelance(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>ขายของ</small>\r\n        </label>\r\n        <Slider\r\n          min={60_000}\r\n          max={1_200_000}\r\n          step={10_000}\r\n          value={incomeMerchant}\r\n          onAfterChange={setIncomeMerchant}\r\n          color={theme.colors.incomeText}\r\n        />\r\n        <div>\r\n          <input\r\n            type=\"number\"\r\n            step={10000}\r\n            min={0}\r\n            value={incomeMerchant}\r\n            onChange={(e) => setIncomeMerchant(e.target.value)}\r\n            style={{ width: \"80px\" }}\r\n          />\r\n        </div>\r\n        {/* <small\r\n          style={{\r\n            display: \"block\",\r\n            gridColumn: \"1 / -1\",\r\n            textAlign: \"right\",\r\n            marginLeft: \"auto\",\r\n            color: theme.colors.textMuted,\r\n            marginTop: \"-10px\",\r\n          }}\r\n        >\r\n          เงินเดือน &times; 12 = รายได้ <b>{numberWithCommas(income)}</b> บาท/ปี\r\n        </small> */}\r\n      </ControlsGrid>\r\n\r\n      <div\r\n        style={{\r\n          margin: \"1rem 0 0.5rem\",\r\n          fontWeight: \"bold\",\r\n          color: theme.colors.expenseText,\r\n          display: \"flex\",\r\n        }}\r\n      >\r\n        <div style={{ flexGrow: 1 }}>ค่าใช้จ่าย</div>\r\n        <div>{expense.toLocaleString()} บาท</div>\r\n      </div>\r\n      <ControlsGrid>\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>คิดจากเงินเดือน + ฟรีแลนซ์</small>\r\n        </label>\r\n        <div style={{ gridColumn: \"2 / -1\", textAlign: \"right\" }}>\r\n          <small>หักได้ {Math.round(expense40_1_2).toLocaleString()} บาท</small>\r\n        </div>\r\n\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>คิดจากขายของ</small>\r\n        </label>\r\n        <div style={{ gridColumn: \"2 / -1\", textAlign: \"right\" }}>\r\n          <small>หักได้ {Math.round(expense40_8).toLocaleString()} บาท</small>\r\n        </div>\r\n      </ControlsGrid>\r\n      <div\r\n        style={{\r\n          margin: \"1rem  0 0.5rem\",\r\n          fontWeight: \"bold\",\r\n          color: theme.colors.allowanceText,\r\n          display: \"flex\",\r\n        }}\r\n      >\r\n        <div style={{ flexGrow: 1 }}>ค่าลดหย่อน</div>\r\n        <div>{allowance.toLocaleString()} บาท</div>\r\n      </div>\r\n      <ControlsGrid style={{gridTemplateColumns: '80px auto 80px'}}>\r\n        <label style={{ flexGrow: 1 }}>\r\n          <small>ค่าลดหย่อน</small>\r\n        </label>\r\n        <Slider\r\n          min={60_000}\r\n          max={1_200_000}\r\n          step={10_000}\r\n          value={allowance}\r\n          onAfterChange={setAllowance}\r\n          color={theme.colors.allowanceText}\r\n        />\r\n        <input\r\n          type=\"number\"\r\n          step={10000}\r\n          min={0}\r\n          value={allowance}\r\n          onChange={(e) => setAllowance(e.target.value)}\r\n          style={{ width: \"80px\" }}\r\n        />\r\n      </ControlsGrid>\r\n      <hr style={{ margin: \"1rem 0\", opacity: 0.2 }} />\r\n      <div style={{ display: \"flex\", alignItems: \"center\", marginTop: \"10px\" }}>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.incomeText }}>รายได้</small>\r\n          <br />\r\n          <span style={{ color: theme.colors.text }}>\r\n            {income.toLocaleString()}\r\n          </span>\r\n        </div>\r\n        <div>→</div>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.incomeText }}>เงินได้สุทธิ</small>\r\n          <br />\r\n          <span style={{ color: theme.colors.text }}>\r\n            {Math.round(netIncome).toLocaleString()}\r\n          </span>\r\n        </div>\r\n        <div>→</div>\r\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\r\n          <small style={{ color: theme.colors.taxText }}>ภาษี</small>\r\n          <br />\r\n          <b>{Math.ceil(taxFinal).toLocaleString()} </b>\r\n        </div>\r\n      </div>\r\n    </ScrollBox>,\r\n    // </div>,\r\n  ];\r\n\r\n  useEffect(() => {\r\n    setEnableIncome(currentNarrativeStep >= 1);\r\n    setEnableExpense(currentNarrativeStep >= 4);\r\n    setGroupIncome(currentNarrativeStep >= 5);\r\n    setShowBreakdown(!(currentNarrativeStep >= 6));\r\n    setTimeout(() => setEnableAllowance(currentNarrativeStep >= 6), 400);\r\n    setShowBrackets(currentNarrativeStep >= 9);\r\n    setActivateTax(currentNarrativeStep >= 10);\r\n  }, [currentNarrativeStep, enableAllowance, income, expense]);\r\n\r\n  return (\r\n    <>\r\n      <StoryIndicator\r\n        currentStep={currentNarrativeStep}\r\n        totalSteps={narrativeSteps.length + 1}\r\n        style={{ marginBottom: \"20px\" }}\r\n      />\r\n      <PageContainer>\r\n        <Step\r\n          status={Math.sign(-1 - currentNarrativeStep)}\r\n          style={{\r\n            gap: \"10px\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n            backgroundColor: theme.colors.bg,\r\n            zIndex: 100,\r\n            top: 30,\r\n            padding: 50,\r\n            paddingTop: 30,\r\n            textAlign: \"center\",\r\n          }}\r\n        >\r\n          <h1>\r\n            เข้าใจภาษี\r\n            <br />\r\n            แบบเห็นภาพ\r\n          </h1>\r\n          <p>\r\n            คำนวณภาษียากจัง!? มาลองคิดภาษี\r\n            <br />\r\n            สไตล์มนุษย์เงินเดือนมือใหม่แบบคร่าวๆ\r\n            <br />\r\n            ผ่าน data visualization กัน!\r\n          </p>\r\n          <Button\r\n            style={{\r\n              padding: \"8px 16px\",\r\n              borderRadius: 8,\r\n              backgroundColor: theme.colors.tax,\r\n              fontWeight: \"bold\",\r\n              fontSize: \"1rem\",\r\n            }}\r\n            onClick={() => setCurrentNarrativeStep(0)}\r\n          >\r\n            เริ่มเลย\r\n          </Button>\r\n          <p style={{ color: theme.colors.textMuted, marginTop: \"1rem\" }}>\r\n            <small>\r\n              *เว็บไซต์นี้ไม่มีการเก็บข้อมูลตัวเลขที่คุณกรอก\r\n              <br />\r\n              และไม่มีข้อผูกพันทางกฎหมายใดๆ\r\n            </small>\r\n          </p>\r\n        </Step>\r\n\r\n        <Step\r\n          status={Math.sign(narrativeSteps.length - currentNarrativeStep)}\r\n          style={{\r\n            gap: \"10px\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n            backgroundColor: theme.colors.bg,\r\n            zIndex: 100,\r\n            top: 30,\r\n            padding: 50,\r\n            paddingTop: 30,\r\n            textAlign: \"center\",\r\n          }}\r\n        >\r\n          <p>\r\n            เรื่องราวเกี่ยวกับภาษียังมีรายละเอียดมากกว่านี้อีก\r\n            สามารถอ่านเพิ่มเติมได้ที่เว็บไซต์\r\n            <a href=\"https://www.rd.go.th/548.html\">กรมสรรพากร</a>\r\n          </p>\r\n          <p>\r\n            แต่ถ้าชอบ visualization นี้\r\n            <br />\r\n            แชร์ให้เพื่อนดูต่อได้เลย\r\n          </p>\r\n          <div style={{ display: \"flex\", gap: \"10px\" }}>\r\n            <div\r\n              class=\"fb-share-button\"\r\n              data-href=\"https://taepras.github.io/taxvisualizer/\"\r\n              data-layout=\"button\"\r\n              data-size=\"large\"\r\n            >\r\n              <a\r\n                target=\"_blank\"\r\n                href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ftaepras.github.io%2Ftaxvisualizer%2F&amp;src=sdkpreparse\"\r\n                class=\"fb-xfbml-parse-ignore\"\r\n              >\r\n                Share\r\n              </a>\r\n            </div>\r\n            <a\r\n              href=\"https://twitter.com/share?ref_src=twsrc%5Etfw\"\r\n              class=\"twitter-share-button\"\r\n              data-size=\"large\"\r\n              data-url=\"https://taepras.github.io/taxvisualizer/\"\r\n              data-via=\"taepras\"\r\n              data-dnt=\"true\"\r\n              data-show-count=\"false\"\r\n            >\r\n              Tweet\r\n            </a>\r\n            <div\r\n              class=\"line-it-button\"\r\n              data-lang=\"en\"\r\n              data-type=\"share-a\"\r\n              data-ver=\"3\"\r\n              data-url=\"https://taepras.github.io/taxvisualizer/\"\r\n              data-color=\"default\"\r\n              data-size=\"large\"\r\n              data-count=\"false\"\r\n              // style={{display: 'none'}}\r\n            ></div>\r\n          </div>\r\n\r\n          <div style={{ display: \"flex\", marginTop: \"1rem\", gap: \"10px\" }}>\r\n            <Button\r\n              style={{\r\n                border: \"none\",\r\n                fontSize: \"1rem\",\r\n                textDecoration: \"underline\",\r\n              }}\r\n              secondary\r\n              onClick={() => setCurrentNarrativeStep(narrativeSteps.length - 1)}\r\n            >\r\n              &laquo; ย้อนกลับ\r\n            </Button>\r\n            <Button\r\n              style={{\r\n                border: \"none\",\r\n                fontSize: \"1rem\",\r\n                textDecoration: \"underline\",\r\n              }}\r\n              secondary\r\n              onClick={() => {\r\n                window.location.href = \"\";\r\n              }}\r\n            >\r\n              &laquo; เริ่มใหม่\r\n            </Button>\r\n          </div>\r\n\r\n          <p style={{ marginTop: \"30px\", color: theme.colors.textMuted }}>\r\n            Tax, visualized. was created by\r\n            <br />\r\n            <a\r\n              href=\"https://taepras.com\"\r\n              style={{ color: theme.colors.textMuted }}\r\n            >\r\n              Tae Prasongpongchai\r\n            </a>\r\n          </p>\r\n        </Step>\r\n\r\n        <>\r\n          <ChartContainer>\r\n            <D3Component\r\n              incomeGroups={[\r\n                {\r\n                  label: `เงินเดือน${\r\n                    incomeFreelanceDisplay > 0 ? \" + ฟรีแลนซ์\" : \"\"\r\n                  }`,\r\n                  income: +salaryDisplay + +incomeFreelanceDisplay,\r\n                  expense: expense40_1_2,\r\n                },\r\n                {\r\n                  label: \"ขายของ\",\r\n                  income: incomeMerchantDisplay,\r\n                  expense: expense40_8,\r\n                },\r\n              ]}\r\n              isGroupIncome={isGroupIncome}\r\n              showBreakdown={showBreakdown}\r\n              income={income}\r\n              expense={expense}\r\n              allowance={allowanceDisplay}\r\n              isPullTax={isPullTax}\r\n              setPullTax={setPullTax}\r\n              enableTransition={enableTransition}\r\n              isActivateTax={isActivateTax}\r\n              showBrackets={showBrackets}\r\n              isBlink={{\r\n                tax: currentNarrativeStep == 10,\r\n                income: currentNarrativeStep == 8,\r\n                // expense: currentNarrativeStep == 2,\r\n                // allowance: currentNarrativeStep == 3,\r\n              }}\r\n            />\r\n          </ChartContainer>\r\n          <SideContainer>\r\n            <ContentContainer>\r\n              {narrativeSteps.map((step, i) => (\r\n                <>\r\n                  <Step status={Math.sign(i - currentNarrativeStep)}>\r\n                    {step}\r\n                  </Step>\r\n                </>\r\n              ))}\r\n            </ContentContainer>\r\n            <div style={{ display: \"flex\", marginTop: \"20px\", gap: \"20px\" }}>\r\n              <Button\r\n                style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}\r\n                onClick={() =>\r\n                  setCurrentNarrativeStep(\r\n                    Math.max(currentNarrativeStep - 1, -1)\r\n                  )\r\n                }\r\n                // disabled={currentNarrativeStep === 0}\r\n                secondary\r\n              >\r\n                ย้อนกลับ\r\n              </Button>\r\n              <Button\r\n                style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}\r\n                onClick={() =>\r\n                  setCurrentNarrativeStep(\r\n                    Math.min(currentNarrativeStep + 1, narrativeSteps.length)\r\n                  )\r\n                }\r\n                disabled={currentNarrativeStep === narrativeSteps.length}\r\n              >\r\n                ต่อไป\r\n              </Button>\r\n            </div>\r\n          </SideContainer>\r\n        </>\r\n      </PageContainer>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}