{"version":3,"sources":["utils/TaxCalculation.js","components/D3Component.jsx","utils/display.js","components/StoryIndicator.jsx","App.js","reportWebVitals.js","index.js"],"names":["useNetIncome","income","expense","allowance","useMemo","Math","max","SvgContainer","styled","div","Fade","CartesianSvg","svg","D3Component","taxBrackets","padding","left","right","top","bottom","isPullTax","showBrackets","isActivateTax","setPullTax","x","transitionTime","enableTransition","isBlink","useDimensions","onResize","observe","unobserve","width","height","entry","transitionDuration","d3Container","useRef","cleanedExpense","cleanedAllowance","min","netIncome","scaleIncome","useCallback","d3","domain","range","barWidth","scaleTaxRate","axisIncomeLeft","tickFormat","axisIncomeRight","axisTaxRate","generateTaxBracketsPathD","d","pathD","map","taxRate","minNetIncome","maxNetIncome","join","length","useLayoutEffect","current","select","attr","style","transition","duration","console","log","text","tax","bracketLineGroups","selectAll","data","bracketLineGroupsEnter","enter","append","classed","merge","toString","replace","i","call","ref","id","className","transform","fill","fontSize","alignmentBaseline","textAnchor","fillOpacity","clipPath","onClick","numberWithCommas","StoryIndicatorContainer","StoryIndicatorItem","props","active","StoryIndicator","currentStep","totalSteps","steps","ChartContainer","SideContainer","Step","status","css","ContentContainer","PageContainer","ControlsContainer","ControlsGrid","Button","button","secondary","disabled","NetIncomeEquation","highlight","display","alignItems","marginTop","flexGrow","textAlign","color","fontWeight","App","useState","salary","setSalary","setAllowance","setEnableTransition","currentNarrativeStep","setCurrentNarrativeStep","setActivateTax","setShowBrackets","enableExpense","setEnableExpense","taxFinal","sumTax","remainingNetIncome","bracketRange","useTaxCalculation","narrativeSteps","type","step","value","onChange","e","target","onMouseDown","onTouchDown","onMouseUp","onTouchUp","marginLeft","ceil","flexBasis","marginBottom","gridColumn","useEffect","sign","gap","justifyContent","backgroundColor","zIndex","paddingTop","borderRadius","class","data-href","data-layout","data-size","href","data-url","data-via","data-dnt","data-show-count","data-lang","data-type","data-ver","data-color","data-count","border","textDecoration","window","location","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8663fdea.chunk.js","sourcesContent":["// export const useTaxCalc = ({income, expense, allowance}) => {\r\n//     return \r\n// }\r\n\r\nimport { useMemo } from \"react\"\r\n\r\nexport const useNetIncome = (income, expense, allowance) => {\r\n    return useMemo(() => {\r\n        return Math.max(0, income - expense - allowance);\r\n      }, [income, expense, allowance]);\r\n}\r\n\r\nexport const useTaxCalculation = (netIncome, taxBrackets) => {\r\n    return useMemo(() => {\r\n        let sumTax = 0;\r\n        let remainingNetIncome = netIncome;\r\n        for (let i in taxBrackets) {\r\n          let bracketRange =\r\n            taxBrackets[i].maxNetIncome - taxBrackets[i].minNetIncome;\r\n          let incomeInBracket = Math.min(remainingNetIncome, bracketRange);\r\n          let taxInBracket = incomeInBracket * taxBrackets[i].taxRate;\r\n          sumTax += taxInBracket;\r\n          remainingNetIncome -= bracketRange;\r\n          if (remainingNetIncome <= 0) break;\r\n        }\r\n        return sumTax;\r\n      }, [netIncome, taxBrackets]);\r\n}","import React, { useRef, useEffect, useLayoutEffect, useMemo, useCallback, useState } from 'react';\r\nimport * as d3 from 'd3';\r\n// import { transition } from 'd3';\r\nimport useDimensions from \"react-cool-dimensions\";\r\nimport styled from 'styled-components';\r\nimport { useResizeDetector } from 'react-resize-detector';\r\nimport { transition } from 'd3';\r\nimport { useNetIncome } from '../utils/TaxCalculation';\r\n\r\n\r\nconst SvgContainer = styled.div`\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n`\r\n\r\nconst Fade = styled.div`\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    height: 20%;\r\n    background: linear-gradient(to bottom, #222, #2220);\r\n`\r\n\r\nconst CartesianSvg = styled.svg`\r\n    & > g text {\r\n        transform: scale(1, -1);\r\n    }\r\n`\r\n\r\n// const transitionDuration = 1000\r\n\r\nexport const D3Component = ({\r\n    income,\r\n    expense,\r\n    allowance,\r\n    taxBrackets,\r\n    padding = {\r\n        left: 35,\r\n        right: 0,\r\n        top: 0,\r\n        bottom: 30,\r\n    },\r\n    isPullTax = false,\r\n    showBrackets = true,\r\n    isActivateTax = true,\r\n    setPullTax = (x) => {},\r\n    transitionTime = 500,\r\n    enableTransition = true,\r\n    isBlink = {}\r\n}) => {\r\n    const { observe, unobserve, width, height, entry } = useDimensions({\r\n        onResize: ({ observe, unobserve, width, height, entry }) => {\r\n            // Triggered whenever the size of the target is changed...\r\n\r\n            unobserve(); // To stop observing the current target element\r\n            observe(); // To re-start observing the current target element\r\n        },\r\n    });\r\n\r\n    const transitionDuration = useMemo(() => enableTransition ? transitionTime : 0, [enableTransition, transitionTime]);\r\n\r\n    const d3Container = useRef(null);\r\n\r\n    const cleanedExpense = useMemo(() => expense < (income - allowance) ? +expense : +Math.max(0, income - allowance), [income, expense]);\r\n    const cleanedAllowance = useMemo(() => Math.min(income, allowance), [income, allowance]);\r\n\r\n    const netIncome = useNetIncome(income, expense, allowance);\r\n\r\n    const scaleIncome = useCallback(\r\n        d3.scaleLinear()\r\n            .domain([0, Math.max(300_000, income * 1.4)])\r\n            .range([0, height - padding.bottom])\r\n        , [height, income, padding])\r\n\r\n    const barWidth = useMemo(() => width - (padding.left + padding.right), [width, padding]);\r\n\r\n    const scaleTaxRate = useCallback(\r\n        d3.scaleLinear()\r\n            .domain([0, 1])\r\n            .range([0, barWidth])\r\n        , [income, width])\r\n\r\n    const axisIncomeLeft = useMemo(() => d3.axisLeft(scaleIncome)\r\n        .tickFormat(d3.format(\".3s\"))\r\n        , [scaleIncome]);\r\n    const axisIncomeRight = useMemo(() => d3.axisRight(scaleIncome), [scaleIncome]);\r\n    const axisTaxRate = useMemo(() => d3.axisBottom(scaleTaxRate).tickFormat(d3.format('.0%'))\r\n        , [scaleTaxRate]);\r\n\r\n    const numberWithCommas = (x) => x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\")\r\n\r\n    const generateTaxBracketsPathD = d => {\r\n        let pathD = 'M 0 0 ';\r\n        pathD += taxBrackets.map((d) => {\r\n            return ''\r\n                + `L ${scaleTaxRate(d.taxRate)} ${scaleIncome(d.minNetIncome)} `\r\n                + `L ${scaleTaxRate(d.taxRate)} ${scaleIncome(d.maxNetIncome)} `\r\n        }).join('')\r\n        pathD += `L 0 ${scaleIncome(taxBrackets[taxBrackets.length - 1].maxNetIncome)} `\r\n        pathD += `Z`\r\n        return pathD;\r\n    }\r\n\r\n    useLayoutEffect(() => {\r\n        if (d3Container.current) {\r\n\r\n            const svg = d3.select(d3Container.current);\r\n\r\n            svg.select('g.container')\r\n                .attr('transform', `translate(${padding.left}, ${padding.bottom})`);\r\n\r\n            svg.select('rect.net-income')\r\n                .attr('width', barWidth)\r\n                .style('animation', isBlink.income ? 'blink-soft 1s infinite' : 'none')\r\n                .transition().duration(transitionDuration)\r\n                .style('fill', '#08f')\r\n                .attr('height', Math.max(0, scaleIncome(netIncome)));\r\n\r\n            svg.select('rect.net-income-mask')\r\n                .attr('width', barWidth)\r\n                .transition().duration(transitionDuration)\r\n                // .style('fill', '#08f')\r\n                .attr('height', Math.max(0, scaleIncome(netIncome)));\r\n\r\n            console.log('netIncome + cleanedAllowance', netIncome + cleanedAllowance, cleanedAllowance, scaleIncome(cleanedAllowance))\r\n            svg.select('rect.expense')\r\n                .attr('width', barWidth)\r\n                .style('animation', isBlink.expense ? 'blink-soft 1s infinite' : 'none')\r\n                .transition().duration(transitionDuration)\r\n                .style('fill', '#312b46')\r\n                .attr('y', scaleIncome(netIncome + cleanedAllowance))\r\n                .attr('height', Math.max(0, scaleIncome(cleanedExpense)));\r\n\r\n            svg.select('rect.allowance')\r\n                .attr('width', barWidth)\r\n                .attr('data-allowance', allowance)\r\n                .attr('data-callowance', cleanedAllowance)\r\n                .attr('data-sallowance', scaleIncome(cleanedAllowance))\r\n                .style('animation', isBlink.allowance ? 'blink-soft 1s infinite' : 'none')\r\n                .transition().duration(transitionDuration)\r\n                .style('fill', '#2a4236')\r\n                .attr('y', scaleIncome(netIncome))\r\n                .attr('height', Math.max(0, scaleIncome(cleanedAllowance)));\r\n\r\n            svg.select('text.net-income-text')\r\n                .text(`เงินได้สุทธิ`)// ${numberWithCommas(netIncome)} บาท`)\r\n                .transition().duration(transitionDuration)\r\n                .attr('x', barWidth / 2)\r\n                .attr('y', -scaleIncome(netIncome / 2))\r\n                .attr('opacity', netIncome > 0 ? 1 : 0)\r\n\r\n            svg.select('text.net-expense-text')\r\n                .text(`ค่าลดหย่อน`)// ${numberWithCommas(allowance)} บาท`)\r\n                .transition().duration(transitionDuration)\r\n                .attr('x', barWidth / 2)\r\n                .attr('y', -scaleIncome(netIncome + cleanedAllowance / 2))\r\n                .attr('opacity', cleanedAllowance > 0 ? 1 : 0)\r\n\r\n            svg.select('text.net-allowance-text')\r\n                .text(`ค่าใช้จ่าย`)// ${numberWithCommas(expense)} บาท`)\r\n                .transition().duration(transitionDuration)\r\n                .attr('x', barWidth / 2)\r\n                .attr('y', -scaleIncome(income - expense / 2))\r\n                .attr('opacity', cleanedExpense > 0 ? 1 : 0)\r\n\r\n            svg.select('path.tax-stairs-camouflage')\r\n                .attr('fill', '#222')\r\n                .transition().duration(transitionDuration)\r\n                .attr('opacity', isActivateTax ? 1 : 0)\r\n                .attr('d', generateTaxBracketsPathD)\r\n\r\n            svg.select('path.tax-stairs')\r\n                .attr('fill', '#f80')\r\n                .style('animation', isActivateTax && isBlink.tax ? 'blink 1s infinite' : 'none')\r\n                .transition().duration(transitionDuration)\r\n                .attr('d', generateTaxBracketsPathD)\r\n                .attr('transform', isPullTax ? `translate(${-50}, 0)` : 'translate(0, 0)')\r\n                .style('opacity', isActivateTax && !isPullTax ? 1 : 0)\r\n\r\n            const bracketLineGroups = svg.select('g.tax-lines')\r\n                .selectAll('g')\r\n                .data(taxBrackets)\r\n\r\n            const bracketLineGroupsEnter = bracketLineGroups\r\n                .enter()\r\n                .append('g')\r\n                .classed('bracket', true)\r\n\r\n            bracketLineGroupsEnter.append('text').classed('bracket-rate-text', true)\r\n            bracketLineGroupsEnter.append('text').classed('bracket-min-text', true)\r\n            bracketLineGroupsEnter.append('rect').classed('bracket-rect', true)\r\n            bracketLineGroupsEnter.append('line').classed('bracket-line', true)\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('rect')\r\n                .attr('x', 0)   // d => scaleTaxRate(d.taxRate))\r\n                .attr('width', d => scaleTaxRate(d.taxRate))\r\n                .style('fill-opacity', 0)\r\n                .style('stroke', '#f80')\r\n                .style(\"stroke-dasharray\", \"3, 3\")\r\n                .transition().duration(transitionDuration)\r\n                .attr('y', d => scaleIncome(d.minNetIncome))\r\n                .attr('height', d => scaleIncome(d.maxNetIncome - d.minNetIncome))\r\n                .attr('opacity', showBrackets ? 1 : 0)\r\n\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('line')\r\n                .attr('x1', 0)\r\n                .attr('x2', barWidth)\r\n                .style('stroke', '#f80')\r\n                .style(\"stroke-dasharray\", \"3, 3\")\r\n                .transition().duration(transitionDuration)\r\n                // .style('stroke-opacity', '0.4')\r\n                .attr('y1', d => scaleIncome(d.maxNetIncome))\r\n                .attr('y2', d => scaleIncome(d.maxNetIncome))\r\n                .attr('opacity', showBrackets ? 1 : 0)\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('text.bracket-rate-text')\r\n                .style('fill', '#fff')\r\n                .style('font-size', '0.75rem')\r\n                .style('text-anchor', 'end')\r\n                .attr('x', barWidth - 5)\r\n                .transition().duration(transitionDuration)\r\n                .text(d => `เริ่มคิดที่ ${numberWithCommas(d.minNetIncome)} บาท`)\r\n                .style('fill-opacity', (d, i) => i != 0 && scaleIncome(d.maxNetIncome - d.minNetIncome) > 20 ? 1 : 0)\r\n                .attr('y', d => -scaleIncome(d.minNetIncome) - 5)\r\n                .attr('opacity', showBrackets ? 1 : 0)\r\n\r\n            bracketLineGroups.merge(bracketLineGroupsEnter)\r\n                .select('text.bracket-min-text')\r\n                .style('fill', '#fff')\r\n                .style('font-size', '0.75rem')\r\n                .attr('x', d => scaleTaxRate(d.taxRate) + 5)\r\n                .transition().duration(transitionDuration)\r\n                .text(d => `ภาษี ${d.taxRate * 100}%`)\r\n                // .text(d => scaleIncome(d.maxNetIncome - d.minNetIncome) > 150\r\n                //     ? `เริ่มคิดที่ ${numberWithCommas(d.minNetIncome)} บาท`\r\n                //     : `${d.taxRate * 100}%`)\r\n                .style('fill-opacity', (d, i) => i != 0 && scaleIncome(d.maxNetIncome - d.minNetIncome) > 20 ? 1 : 0)\r\n                .attr('y', d => -scaleIncome(d.minNetIncome) - 5)\r\n                .attr('opacity', showBrackets ? 1 : 0)\r\n\r\n            // AXES\r\n\r\n            d3.select(\"g.axis-income-bottom\")\r\n                .attr(\"transform\", `translate(0, 0)`)\r\n                .transition().duration(transitionDuration)\r\n                .call(axisIncomeLeft);\r\n\r\n            d3.select(\"g.axis-tax-rate\")\r\n                // .attr(\"transform\", `translate(-10, 0)`)\r\n                .transition().duration(transitionDuration)\r\n                .call(axisTaxRate);\r\n        }\r\n    }, [\r\n        width, height,\r\n        d3Container,\r\n        isPullTax,\r\n        barWidth,\r\n        scaleIncome,\r\n        netIncome,\r\n        income,\r\n        expense,\r\n        allowance,\r\n        taxBrackets,\r\n        padding,\r\n        axisIncomeLeft,\r\n        axisIncomeRight,\r\n        axisTaxRate,\r\n        cleanedAllowance,\r\n        cleanedExpense,\r\n        scaleTaxRate\r\n    ]);\r\n\r\n    return (<>\r\n        <SvgContainer ref={observe}>\r\n            <Fade />\r\n            <CartesianSvg\r\n                id=\"chart\"\r\n                className=\"d3-component\"\r\n                width={width}\r\n                height={height}\r\n                ref={d3Container}\r\n            >\r\n                <defs>\r\n                    <clipPath id=\"net-income-mask\">\r\n                        <rect className=\"net-income-mask\" />\r\n                    </clipPath>\r\n                </defs>\r\n                <g transform={`translate(0, ${height}) scale(1, -1)`}>\r\n                    <g className=\"container\">\r\n                        <rect className=\"net-income\" />\r\n                        <rect className=\"expense\" />\r\n                        <rect className=\"allowance\" />\r\n                        <text className=\"net-income-text\" style={{\r\n                            fill: '#fff', fontSize: '0.75rem', alignmentBaseline: 'middle', textAnchor: 'middle', fillOpacity: 0.4\r\n                        }} />\r\n                        <text className=\"net-expense-text\" style={{\r\n                            fill: '#fff', fontSize: '0.75rem', alignmentBaseline: 'middle', textAnchor: 'middle', fillOpacity: 0.4\r\n                        }} />\r\n                        <text className=\"net-allowance-text\" style={{\r\n                            fill: '#fff', fontSize: '0.75rem', alignmentBaseline: 'middle', textAnchor: 'middle', fillOpacity: 0.4\r\n                        }} />\r\n                        <g className=\"tax-lines\" />\r\n                        <g className=\"axis axis-income-top\" />\r\n                        <g className=\"axis axis-income-bottom\" />\r\n                        <g className=\"axis axis-tax-rate\" />\r\n                        <path className=\"tax-stairs-camouflage\" clipPath=\"url(#net-income-mask)\" onClick={() => setPullTax(false)} />\r\n                        <path className=\"tax-stairs\" clipPath=\"url(#net-income-mask)\" onClick={() => setPullTax(!isPullTax)} />\r\n                    </g>\r\n                </g>\r\n            </CartesianSvg>\r\n        </SvgContainer>\r\n    </>);\r\n}","export const numberWithCommas = (x) => x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\")\r\n","import React, { useMemo } from 'react';\r\nimport styled from 'styled-components';\r\nimport * as d3 from 'd3'\r\n\r\nconst StoryIndicatorContainer = styled.div`\r\n    display: flex;\r\n    gap: 4px;\r\n    position: absolute;\r\n    top: 15px;\r\n    left: 30px;\r\n    right: 30px;\r\n    z-index: 100;\r\n\r\n    @media (min-width: 480px) {\r\n        width: 500px;\r\n        margin: auto;\r\n    }\r\n`\r\n\r\nconst StoryIndicatorItem = styled.div`\r\n    height: 2px;\r\n    flex-grow: 1;\r\n    border-radius: 999;\r\n    background-color: #fff;\r\n    transition: opacity 0.2s;\r\n    opacity: ${props => props.active ? 1 : 0.2};\r\n`\r\n\r\nconst StoryIndicator = ({ currentStep = 0, totalSteps = 0, ...props }) => {\r\n    const steps = useMemo(() => d3.range(totalSteps), [totalSteps]);\r\n\r\n    return (\r\n        <>\r\n            <StoryIndicatorContainer {...props}>\r\n                {steps.map((d, i) => (\r\n                    <StoryIndicatorItem active={i <= currentStep} />\r\n                ))}\r\n            </StoryIndicatorContainer>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default StoryIndicator;","import { useEffect, useMemo, useState } from \"react\";\nimport { D3Component } from \"./components/D3Component\";\nimport styled, { css } from \"styled-components\";\nimport \"./App.css\";\nimport { numberWithCommas } from \"./utils/display\";\nimport { useNetIncome, useTaxCalculation } from \"./utils/TaxCalculation\";\nimport StoryIndicator from \"./components/StoryIndicator\";\n\nconst ChartContainer = styled.div`\n  /* padding: 30px; */\n  width: 100%;\n  margin-top: 10px;\n  /* height: 50vh; */\n  flex: 1;\n  position: relative;\n  transition: all 0.2s;\n`;\n\nconst SideContainer = styled.div`\n  height: 220px;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n\n  @media (min-width: 480px) {\n    height: auto;\n    margin-left: 80px;\n    width: 40%;\n    max-width: 400px;\n    justify-content: center;\n  }\n`;\n\nconst Step = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  flex-grow: 1;\n  transition: all 0.5s;\n\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n\n  ${(props) => {\n    switch (props.status) {\n      case -1:\n        return css`\n          transform: translateX(-100px);\n          opacity: 0;\n          pointer-events: none;\n        `;\n        break;\n      case 1:\n        return css`\n          transform: translateX(100px);\n          opacity: 0;\n          pointer-events: none;\n        `;\n        break;\n      default:\n        return css`\n          /* transform: translateX(-100px):  */\n          /* opacity: 0; */\n          /* pointer-events: none; */\n        `;\n        break;\n    }\n  }}\n`;\n\nconst StepOnly = styled.div`\n  ${(props) => {\n    switch (props.status) {\n      case -1:\n        return css`\n          transform: translateX(-100px);\n          opacity: 0;\n          pointer-events: none;\n        `;\n        break;\n      case 1:\n        return css`\n          transform: translateX(100px);\n          opacity: 0;\n          pointer-events: none;\n        `;\n        break;\n      default:\n        return css`\n          /* transform: translateX(-100px):  */\n          /* opacity: 0; */\n          /* pointer-events: none; */\n        `;\n        break;\n    }\n  }}\n`;\n\nconst ContentContainer = styled.div`\n  /* height: 200px; */\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  flex-grow: 1;\n  position: relative;\n\n  @media (min-width: 480px) {\n    height: 240px;\n    flex-grow: 0;\n  }\n`;\n\nconst PageContainer = styled.div`\n  padding: 30px;\n  /* padding-top: 15px; */\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  gap: 10px;\n  flex-direction: column;\n  overflow: hidden;\n\n  @media (min-width: 480px) {\n    flex-direction: row;\n    padding: 50px;\n  }\n`;\n\nconst ControlsContainer = styled.div`\n  /* margin-top: 30px; */\n  display: flex;\n  /* grid-template-columns: auto auto 80px; */\n  /* column-gap: 10px; */\n  /* row-gap: 15px; */\n  gap: 0.5rem;\n  flex-direction: column;\n  /* margin-bottom: 30px; */\n  align-content: center;\n\n  label {\n    white-space: nowrap;\n  }\n`;\n\nconst ControlsGrid = styled.div`\n  /* margin-top: 30px; */\n  display: grid;\n  grid-template-columns: auto auto 80px;\n  column-gap: 10px;\n  row-gap: 5px;\n  /* margin-bottom: 30px; */\n  align-content: center;\n\n  label {\n    white-space: nowrap;\n  }\n`;\n\nconst InputGroup = styled.div`\n  /* margin-bottom: 10px; */\n  display: flex;\n  flex-direction: column;\n`;\n\nconst Button = styled.button`\n  border: none;\n  border-radius: 4px;\n  padding: 4px 8px;\n  font-family: \"Bai Jamjuree\", sans-serif;\n\n  ${(props) =>\n    props.secondary\n      ? css`\n          border: 1px white solid;\n          background-color: transparent;\n          color: white;\n        `\n      : css`\n          background-color: white;\n        `}\n\n  ${(props) =>\n    props.disabled &&\n    css`\n      opacity: 0.4;\n    `}\n`;\n\nfunction NetIncomeEquation({ income, expense, allowance, highlight = {} }) {\n  const netIncome = useNetIncome(income, expense, allowance);\n  return (\n    <div style={{ display: \"flex\", alignItems: \"center\", marginTop: \"10px\" }}>\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\n        <small style={{ color: highlight.income ? \"#0af\" : \"#888\" }}>\n          รายได้\n        </small>\n        <br />\n        <small\n          style={{\n            fontWeight: highlight.income ? \"bold\" : \"normal\",\n            color: highlight.income ? \"#fff\" : \"#888\",\n          }}\n        >\n          {numberWithCommas(income)}\n        </small>\n      </div>\n      <div>−</div>\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\n        <small style={{ color: highlight.expense ? \"#9c86eb\" : \"#888\" }}>\n          ค่าใช้จ่าย\n        </small>\n        <br />\n        <small\n          style={{\n            fontWeight: highlight.expense ? \"bold\" : \"normal\",\n            color: highlight.expense ? \"#fff\" : \"#888\",\n          }}\n        >\n          {numberWithCommas(expense)}\n        </small>\n      </div>\n      <div>−</div>\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\n        <small style={{ color: highlight.allowance ? \"#58cc92\" : \"#888\" }}>\n          ลดหย่อน\n        </small>\n        <br />\n        <small\n          style={{\n            fontWeight: highlight.allowance ? \"bold\" : \"normal\",\n            color: highlight.allowance ? \"#fff\" : \"#888\",\n          }}\n        >\n          {numberWithCommas(allowance)}\n        </small>\n      </div>\n      <div>=</div>\n      <div style={{ flexGrow: 1, textAlign: \"center\" }}>\n        <small style={{ color: highlight.netIncome ? \"#0af\" : \"#888\" }}>\n          เงินได้สุทธิ\n        </small>\n        <br />\n        <small\n          style={{\n            fontWeight: highlight.netIncome ? \"bold\" : \"normal\",\n            color: highlight.netIncome ? \"#fff\" : \"#888\",\n          }}\n        >\n          {numberWithCommas(netIncome)} ฿\n        </small>\n      </div>\n    </div>\n  );\n}\n\nfunction App() {\n  const [salary, setSalary] = useState(0);\n  // const [income, setIncome] = useState(0);\n  const income = useMemo(() => salary * 12, [salary]);\n  // const [expense, setExpense] = useState(0);\n  const expense = useMemo(() => Math.min(income * 0.5, 100_000), [income]);\n\n  const [allowance, setAllowance] = useState(0);\n  const [enableTransition, setEnableTransition] = useState(true);\n  const [currentNarrativeStep, setCurrentNarrativeStep] = useState(-1);\n\n  const [isPullTax, setPullTax] = useState(false);\n  const [isActivateTax, setActivateTax] = useState(false);\n  const [showBrackets, setShowBrackets] = useState(false);\n\n  const [enableExpense, setEnableExpense] = useState(0);\n\n  const taxBrackets = [\n    {\n      minNetIncome: 0,\n      maxNetIncome: 150000,\n      taxRate: 0,\n    },\n    {\n      minNetIncome: 150000,\n      maxNetIncome: 300000,\n      taxRate: 0.05,\n    },\n    {\n      minNetIncome: 300000,\n      maxNetIncome: 500000,\n      taxRate: 0.1,\n    },\n    {\n      minNetIncome: 500000,\n      maxNetIncome: 750000,\n      taxRate: 0.15,\n    },\n    {\n      minNetIncome: 750000,\n      maxNetIncome: 1000000,\n      taxRate: 0.2,\n    },\n    {\n      minNetIncome: 1000000,\n      maxNetIncome: 2000000,\n      taxRate: 0.25,\n    },\n    {\n      minNetIncome: 2000000,\n      maxNetIncome: 5000000,\n      taxRate: 0.3,\n    },\n    {\n      minNetIncome: 5000000,\n      maxNetIncome: 999999999999,\n      taxRate: 0.35,\n    },\n  ];\n\n  const netIncome = useNetIncome(income, expense, allowance);\n  const taxFinal = useTaxCalculation(netIncome, taxBrackets);\n\n  const narrativeSteps = [\n    <>\n      <p style={{ textAlign: \"center\" }}>\n        \"<span style={{ color: \"#f90\" }}>ภาษีเงินได้บุคคลธรรมดา</span>\" คิดจาก \"\n        <span style={{ color: \"#0af\" }}>เงินได้สุทธิ</span>\"\n        ซึ่งคำนวณจากรายได้ของเราหลังจากหักค่าใช้จ่ายแล้ว\n      </p>\n      <div style={{ display: \"flex\", alignItems: \"center\" }}>\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\n          <span style={{ color: \"#0af\" }}>เงินได้สุทธิ</span>\n        </div>\n        <div>=</div>\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\n          <span>รายได้</span>\n        </div>\n        <div>−</div>\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\n          <span>ค่าใช้จ่าย</span>\n        </div>\n        <div>−</div>\n        <div style={{ flexGrow: 1, textAlign: \"center\" }}>\n          <span>ค่าลดหย่อน</span>\n        </div>\n\n        {/* <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\n          <small>ภาษี</small>\n          <br />\n          <b>{numberWithCommas(Math.ceil(taxFinal))} ฿</b>\n        </div> */}\n      </div>\n    </>,\n\n    <>\n      <ControlsContainer>\n        <div style={{ display: \"flex\" }}>\n          <label style={{ flexGrow: 1 }}>เงินเดือน</label>\n          <input\n            type=\"number\"\n            step={10000}\n            min={0}\n            value={salary}\n            onChange={(e) => setSalary(e.target.value)}\n            style={{ width: \"80px\" }}\n          />\n        </div>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"1000000\"\n          value={salary}\n          onChange={(e) => setSalary(e.target.value)}\n          onMouseDown={() => setEnableTransition(false)}\n          onTouchDown={() => setEnableTransition(false)}\n          onMouseUp={() => setEnableTransition(true)}\n          onTouchUp={() => setEnableTransition(false)}\n        />\n      </ControlsContainer>\n      <small style={{ marginLeft: \"auto\", color: \"#888\" }}>\n        เงินเดือน &times; 12 = {numberWithCommas(income)} บาท/ปี\n      </small>\n      <NetIncomeEquation\n        income={income}\n        expense={expense}\n        allowance={allowance}\n        highlight={{ income: true }}\n      />\n    </>,\n\n    <>\n      <p style={{ textAlign: \"center\" }}>\n        หักค่าใช้จ่ายได้ 50% ของรายได้\n        <br />\n        แต่ไม่เกิน 100,000 บาท\n      </p>\n      <NetIncomeEquation\n        income={income}\n        expense={expense}\n        allowance={allowance}\n        highlight={{ expense: true }}\n      />\n    </>,\n\n    <>\n      {/* <p>ลดหย่อนส่วนตัวได้ 60,000 บาท</p> */}\n      <ControlsContainer>\n        <div style={{ display: \"flex\" }}>\n          <label style={{ flexGrow: 1 }}>ค่าลดหย่อน</label>\n          <input\n            type=\"number\"\n            step={10000}\n            min={0}\n            value={allowance}\n            onChange={(e) => setAllowance(e.target.value)}\n            style={{ width: \"80px\" }}\n          />\n        </div>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"1000000\"\n          value={allowance}\n          onChange={(e) => setAllowance(e.target.value)}\n          onMouseDown={() => setEnableTransition(false)}\n          onTouchDown={() => setEnableTransition(false)}\n          onMouseUp={() => setEnableTransition(true)}\n          onTouchUp={() => setEnableTransition(false)}\n        />\n      </ControlsContainer>\n      <small style={{ marginLeft: \"auto\", color: \"#888\" }}>\n        ลดหย่อนส่วนตัวได้ 60,000 บาท\n      </small>\n      <NetIncomeEquation\n        income={income}\n        expense={expense}\n        allowance={allowance}\n        highlight={{ allowance: true }}\n      />\n    </>,\n\n    <>\n      <p style={{ textAlign: \"center\" }}>\n        \"<span style={{ color: \"#0af\" }}>เงินได้สุทธิ</span>\" ของคุณคือ{\" \"}\n        <b>{numberWithCommas(netIncome)}</b> บาท\n      </p>\n      <NetIncomeEquation\n        income={income}\n        expense={expense}\n        allowance={allowance}\n        highlight={{ netIncome: true }}\n      />\n    </>,\n\n    <>\n      <p style={{ textAlign: \"center\" }}>\n        เมื่อได้ \"<span style={{ color: \"#0af\" }}>เงินได้สุทธิ</span>\" แล้ว\n        <br />\n        จะต้องนำตัวเลขที่ได้ไปเข้า \"\n        <span style={{ color: \"#f90\" }}>ขั้นบันไดภาษี</span>\"\n        <br />\n        เพื่อคำนวณภาษีที่จะต้องจ่าย\n      </p>\n    </>,\n\n    <>\n      <p style={{ textAlign: \"center\" }}>\n        ดังนั้น <span style={{ color: \"#f90\" }}>ภาษีเงินได้บุคคลธรรมดา</span>\n        <br />\n        ที่คุณจะต้องเสียคือ{\" \"}\n        <b style={{ color: \"#f90\" }}>\n          {numberWithCommas(Math.ceil(taxFinal))}\n        </b>{\" \"}\n        บาท\n      </p>\n      <div style={{ display: \"flex\", alignItems: \"center\" }}>\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\n          <small style={{ color: \"#888\" }}>รายได้</small>\n          <br />\n          <span style={{ color: \"#888\" }}>{numberWithCommas(income)}</span>\n        </div>\n        <div>→</div>\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\n          <small style={{ color: \"#888\" }}>เงินได้สุทธิ</small>\n          <br />\n          <span style={{ color: \"#888\" }}>{numberWithCommas(netIncome)}</span>\n        </div>\n        <div>→</div>\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\n          <small style={{ color: \"#f90\" }}>ภาษี</small>\n          <br />\n          <b>{numberWithCommas(Math.ceil(taxFinal))} ฿</b>\n        </div>\n      </div>\n    </>,\n\n    <>\n      <p style={{ marginBottom: \"0.5rem\" }}>\n        <b>ลองปรับตัวเลขดู</b>\n      </p>\n      <ControlsGrid>\n        <label style={{ flexGrow: 1 }}>\n          <small>เงินเดือน</small>\n        </label>\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"1000000\"\n          value={salary}\n          onChange={(e) => setSalary(e.target.value)}\n          onMouseDown={() => setEnableTransition(false)}\n          onTouchDown={() => setEnableTransition(false)}\n          onMouseUp={() => setEnableTransition(true)}\n          onTouchUp={() => setEnableTransition(false)}\n        />\n        <div>\n          <input\n            type=\"number\"\n            step={10000}\n            min={0}\n            value={salary}\n            onChange={(e) => setSalary(e.target.value)}\n            style={{ width: \"80px\" }}\n          />\n        </div>\n        {/* <small\n          style={{\n            display: \"block\",\n            gridColumn: \"1 / -1\",\n            textAlign: \"right\",\n            marginLeft: \"auto\",\n            color: \"#888\",\n            marginTop: \"-10px\",\n          }}\n        >\n          เงินเดือน &times; 12 = รายได้ <b>{numberWithCommas(income)}</b> บาท/ปี\n        </small> */}\n        <label style={{ flexGrow: 1 }}>\n          <small>ค่าใช้จ่าย</small>\n        </label>\n        <div style={{ gridColumn: \"2 / -1\" }}>\n          <small>หักได้ {numberWithCommas(expense)} บาท</small>\n        </div>\n        <label style={{ flexGrow: 1 }}>\n          <small>ค่าลดหย่อน</small>\n        </label>\n        <input\n          type=\"range\"\n          min=\"60000\"\n          max=\"1000000\"\n          value={allowance}\n          onChange={(e) => setAllowance(e.target.value)}\n          onMouseDown={() => setEnableTransition(false)}\n          onTouchDown={() => setEnableTransition(false)}\n          onMouseUp={() => setEnableTransition(true)}\n          onTouchUp={() => setEnableTransition(false)}\n        />\n        <input\n          type=\"number\"\n          step={10000}\n          min={0}\n          value={allowance}\n          onChange={(e) => setAllowance(e.target.value)}\n          style={{ width: \"80px\" }}\n        />\n      </ControlsGrid>\n      <div style={{ display: \"flex\", alignItems: \"center\", marginTop: \"20px\" }}>\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\n          <small style={{ color: \"#0af\" }}>รายได้</small>\n          <br />\n          <span style={{ color: \"#fff\" }}>{numberWithCommas(income)}</span>\n        </div>\n        <div>→</div>\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\n          <small style={{ color: \"#0af\" }}>เงินได้สุทธิ</small>\n          <br />\n          <span style={{ color: \"#fff\" }}>{numberWithCommas(netIncome)}</span>\n        </div>\n        <div>→</div>\n        <div style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}>\n          <small style={{ color: \"#f90\" }}>ภาษี</small>\n          <br />\n          <b>{numberWithCommas(Math.ceil(taxFinal))} ฿</b>\n        </div>\n      </div>\n    </>,\n  ];\n\n  useEffect(() => {\n    if (currentNarrativeStep == 1) {\n      if (income == 0) setSalary(30_000);\n    }\n\n    if (currentNarrativeStep == 2) {\n      setEnableExpense(true); //Expense(Math.min(income / 2, 100_000));\n    }\n\n    if (currentNarrativeStep == 3) {\n      if (allowance == 0) setAllowance(60_000);\n    }\n\n    if (currentNarrativeStep == 5) {\n      setShowBrackets(true);\n    }\n\n    if (currentNarrativeStep >= 6) {\n      setActivateTax(true);\n    } else {\n      setActivateTax(false);\n    }\n  }, [currentNarrativeStep, allowance, income, expense]);\n\n  return (\n    <>\n      <StoryIndicator\n        currentStep={currentNarrativeStep}\n        totalSteps={narrativeSteps.length}\n        style={{ marginBottom: \"20px\" }}\n      />\n      <PageContainer>\n        <Step\n          status={Math.sign(-1 - currentNarrativeStep)}\n          style={{\n            gap: \"10px\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            backgroundColor: \"#222\",\n            zIndex: 100,\n            top: 50,\n            padding: 50,\n            paddingTop: 0,\n            textAlign: \"center\",\n          }}\n        >\n          <h1>Tax, visualized.</h1>\n          <p>\n            คำนวณภาษียากจัง!?\n            <br />\n            มาลองคำนวณภาษีมนุษย์เงินเดือน\n            <br />\n            แบบเห็นภาพกัน\n          </p>\n          <Button\n            style={{\n              padding: \"8px 16px\",\n              borderRadius: 8,\n              backgroundColor: \"#f80\",\n              fontWeight: \"bold\",\n              fontSize: \"1rem\",\n            }}\n            onClick={() => setCurrentNarrativeStep(0)}\n          >\n            เริ่มเลย\n          </Button>\n        </Step>\n\n        <Step\n          status={Math.sign(narrativeSteps.length - currentNarrativeStep)}\n          style={{\n            gap: \"10px\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            backgroundColor: \"#222\",\n            zIndex: 100,\n            top: 50,\n            padding: 50,\n            paddingTop: 0,\n            textAlign: \"center\",\n          }}\n        >\n          <p>\n            ถ้าชอบ visualization นี้\n            <br />\n            แชร์ให้เพื่อนดูต่อได้เลย\n          </p>\n          <div style={{ display: \"flex\", gap: \"10px\" }}>\n            <div\n              class=\"fb-share-button\"\n              data-href=\"https://taepras.github.io/taxvisualizer/\"\n              data-layout=\"button\"\n              data-size=\"large\"\n            >\n              <a\n                target=\"_blank\"\n                href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ftaepras.github.io%2Ftaxvisualizer%2F&amp;src=sdkpreparse\"\n                class=\"fb-xfbml-parse-ignore\"\n              >\n                Share\n              </a>\n            </div>\n            <a\n              href=\"https://twitter.com/share?ref_src=twsrc%5Etfw\"\n              class=\"twitter-share-button\"\n              data-size=\"large\"\n              data-url=\"https://taepras.github.io/taxvisualizer/\"\n              data-via=\"taepras\"\n              data-dnt=\"true\"\n              data-show-count=\"false\"\n            >\n              Tweet\n            </a>\n            <div\n              class=\"line-it-button\"\n              data-lang=\"en\"\n              data-type=\"share-a\"\n              data-ver=\"3\"\n              data-url=\"https://taepras.github.io/taxvisualizer/\"\n              data-color=\"default\"\n              data-size=\"large\"\n              data-count=\"false\"\n              // style={{display: 'none'}}\n            ></div>\n          </div>\n\n          <div style={{ display: \"flex\", marginTop: \"1rem\", gap: \"10px\" }}>\n            <Button\n              style={{\n                border: \"none\",\n                fontSize: \"1rem\",\n                textDecoration: \"underline\",\n              }}\n              secondary\n              onClick={() => setCurrentNarrativeStep(narrativeSteps.length - 1)}\n            >\n              &laquo; ย้อนกลับ\n            </Button>\n            <Button\n              style={{\n                border: \"none\",\n                fontSize: \"1rem\",\n                textDecoration: \"underline\",\n              }}\n              secondary\n              onClick={() => {\n                window.location.href = \"\";\n              }}\n            >\n              &laquo; เริ่มใหม่\n            </Button>\n          </div>\n\n          <p style={{ marginTop: '30px', color: '#888' }}>\n            Tax, visualized. was created by<br/>\n            <a href=\"https://taepras.com\" style={{ color: '#888' }}>Tae Prasongpongchai</a>\n            </p>\n\n        </Step>\n\n        <>\n          <ChartContainer>\n            <D3Component\n              income={income}\n              expense={enableExpense ? expense : 0}\n              allowance={allowance}\n              taxBrackets={taxBrackets}\n              isPullTax={isPullTax}\n              setPullTax={setPullTax}\n              enableTransition={enableTransition}\n              isActivateTax={isActivateTax}\n              showBrackets={showBrackets}\n              isBlink={{\n                tax: currentNarrativeStep == 6,\n                income: currentNarrativeStep == 4,\n                // expense: currentNarrativeStep == 2,\n                // allowance: currentNarrativeStep == 3,\n              }}\n            />\n          </ChartContainer>\n          <SideContainer>\n            <ContentContainer>\n              {narrativeSteps.map((step, i) => (\n                <>\n                  <Step status={Math.sign(i - currentNarrativeStep)}>\n                    {step}\n                  </Step>\n                </>\n              ))}\n            </ContentContainer>\n            <div style={{ display: \"flex\", marginTop: \"20px\", gap: \"20px\" }}>\n              <Button\n                style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}\n                onClick={() =>\n                  setCurrentNarrativeStep(\n                    Math.max(currentNarrativeStep - 1, -1)\n                  )\n                }\n                // disabled={currentNarrativeStep === 0}\n                secondary\n              >\n                ย้อนกลับ\n              </Button>\n              <Button\n                style={{ flexGrow: 1, flexBasis: 0, textAlign: \"center\" }}\n                onClick={() =>\n                  setCurrentNarrativeStep(\n                    Math.min(currentNarrativeStep + 1, narrativeSteps.length)\n                  )\n                }\n                disabled={currentNarrativeStep === narrativeSteps.length}\n              >\n                ต่อไป\n              </Button>\n            </div>\n          </SideContainer>\n        </>\n      </PageContainer>\n    </>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}